<!doctype html><html lang=zh-cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><link rel=canonical type=text/html href=https://www.kubeclipper.io/docs/><link rel=alternate type=application/rss+xml href=https://www.kubeclipper.io/docs/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>æ–‡æ¡£ | KubeClipper</title><meta name=description content><meta property="og:title" content="æ–‡æ¡£"><meta property="og:description" content="â˜¸ï¸ Manage kubernetes in the most light and convenient way â˜¸ï¸"><meta property="og:type" content="website"><meta property="og:url" content="https://www.kubeclipper.io/docs/"><meta property="og:site_name" content="KubeClipper"><meta itemprop=name content="æ–‡æ¡£"><meta itemprop=description content="â˜¸ï¸ Manage kubernetes in the most light and convenient way â˜¸ï¸"><meta name=twitter:card content="summary"><meta name=twitter:title content="æ–‡æ¡£"><meta name=twitter:description content="â˜¸ï¸ Manage kubernetes in the most light and convenient way â˜¸ï¸"><link rel=preload href=/scss/main.min.8e06a4662f78e6bea9247547ec59da9a543b48caadb4c359caf029c6f470f880.css as=style><link href=/scss/main.min.8e06a4662f78e6bea9247547ec59da9a543b48caadb4c359caf029c6f470f880.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" viewBox="0 0 200 200" enable-background="new 0 0 200 200"><image id="image0" width="200" height="200" x="0" y="0" href="data:image/png;base64,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 RK5CYII="/></svg></span><span class=navbar-brand__name>KubeClipper</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>æ–‡æ¡£</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>åšå®¢</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>ç¤¾åŒº</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>latest</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/>vlatest (latest)</a>
<a class=dropdown-item href=/v1.3>v1.3</a>
<a class=dropdown-item href=/v1.2>v1.2</a>
<a class=dropdown-item href=/v1.1>v1.1</a></div></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>ç®€ä½“ä¸­æ–‡</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/en/docs/>English</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; ç«™å†…æœç´¢â€¦" aria-label=ç«™å†…æœç´¢â€¦ autocomplete=off data-offline-search-index-json-src=/offline-search-index.a254a82192c3bc6bbe46a035f418e5de.json data-offline-search-base-href=/ data-offline-search-max-results=25></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>è¿™æ˜¯æœ¬èŠ‚çš„å¤šé¡µæ‰“å°è§†å›¾ã€‚
<a href=# onclick="return print(),!1">ç‚¹å‡»æ­¤å¤„æ‰“å°</a>.</p><p><a href=/docs/>è¿”å›æœ¬é¡µå¸¸è§„è§†å›¾</a>.</p></div><h1 class=title>æ–‡æ¡£</h1><ul><li>1: <a href=#pg-6e17e09fffc1050f46600282def85180>æ¦‚è¿°</a></li><ul></ul><li>2: <a href=#pg-93aadc1aba179e6928539400a09b9e4e>å¿«é€Ÿå¼€å§‹</a></li><ul><li>2.1: <a href=#pg-51e07dd308860dc8b1808e7299ac75d8>éƒ¨ç½² AIO</a></li><li>2.2: <a href=#pg-45c14578741098628f1d483b1891e15d>ä½¿ç”¨ Kubeclipper ç¦»çº¿åˆ›å»º kubernetes é›†ç¾¤</a></li></ul><li>3: <a href=#pg-a07813ac798dd2637717ce2e67c448bd>éƒ¨ç½²æ–‡æ¡£</a></li><ul><li>3.1: <a href=#pg-1ed184c63a9ba32659457db911ea314c>éƒ¨ç½²é«˜å¯ç”¨ KubeClipper</a></li></ul><li>4: <a href=#pg-8dbd4e302cd86a4d0f71f71ce3b300de>ä½¿ç”¨æ‰‹å†Œ</a></li><ul><li>4.1: <a href=#pg-2cc05f33f011eb2f0671dd748cff9826>åˆ›å»ºé›†ç¾¤</a></li><li>4.2: <a href=#pg-d02d74740bfa769ed1533f083ba56ac2>é›†ç¾¤æ‰˜ç®¡</a></li><li>4.3: <a href=#pg-a8bf4ad6bad192cf81433dc9082057f8>é›†ç¾¤ç®¡ç†</a></li><li>4.4: <a href=#pg-14a1d24a0e318e4086c90931bd9e8c35>èŠ‚ç‚¹ç®¡ç†</a></li><li>4.5: <a href=#pg-9db4787abe05db7c233072bf3fa9f94e>è®¿é—®æ§åˆ¶</a></li></ul><li>5: <a href=#pg-2a24abb89b7115d59d639d3389ce3c9b>å¸¸è§é—®é¢˜</a></li><ul><li>5.1: <a href=#pg-54fa90c08fd01c12b3bbec84936325aa>é€šè¿‡ kcctl å‘½ä»¤åˆ›å»ºé›†ç¾¤é”™è¯¯</a></li></ul><li>6: <a href=#pg-8efbf7499fe9c7bde8d2c1bb7ff6ee3c>è´¡çŒ®æŒ‡å—</a></li><ul></ul></ul><div class=content></div></div><div class=td-content><h1 id=pg-6e17e09fffc1050f46600282def85180>1 - æ¦‚è¿°</h1><div class=lead>Manage kubernetes in the most light and convenient way â˜¸ï¸</div><h2 id=kubeclipper-æ˜¯ä»€ä¹ˆ>KubeClipper æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>KubeClipper æ—¨åœ¨æä¾›æ˜“ä½¿ç”¨ã€æ˜“è¿ç»´ã€æè½»é‡ã€ç”Ÿäº§çº§çš„ Kubernetes å¤šé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†æœåŠ¡ï¼Œè®©è¿ç»´å·¥ç¨‹å¸ˆä»ç¹å¤çš„é…ç½®å’Œæ™¦æ¶©çš„å‘½ä»¤è¡Œä¸­è§£æ”¾å‡ºæ¥ï¼Œå®ç°ä¸€ç«™å¼ç®¡ç†è·¨åŒºåŸŸã€è·¨åŸºç¡€è®¾æ–½çš„å¤š kubernetes é›†ç¾¤ã€‚</p><h2 id=ä¸ºä»€ä¹ˆéœ€è¦-kubeclipper>ä¸ºä»€ä¹ˆéœ€è¦ KubeClipperï¼Ÿ</h2><p>äº‘åŸç”Ÿæ—¶ä»£ï¼ŒKubernetes å·²æ¯‹åº¸ç½®ç–‘åœ°æˆä¸ºå®¹å™¨ç¼–æ’çš„äº‹å®æ ‡å‡†ã€‚è™½ç„¶æœ‰è¯¸å¤šè¾…åŠ© kubernetes é›†ç¾¤å®‰è£…å’Œç®¡ç†çš„å·¥å…·ï¼Œä½†æ­å»ºå’Œè¿ç»´ä¸€å¥—ç”Ÿäº§çº§åˆ«çš„ kubernetes é›†ç¾¤ä»ç„¶ååˆ†å¤æ‚ã€‚ä¹å·äº‘åœ¨å¤§é‡çš„æœåŠ¡å’Œå®è·µè¿‡ç¨‹ä¸­ï¼Œæ²‰æ·€å‡ºä¸€ä¸ªæè½»é‡ã€æ˜“ä½¿ç”¨çš„å›¾å½¢åŒ–ç•Œé¢ Kubernetes å¤šé›†ç¾¤ç®¡ç†å·¥å…·â€”â€” KubeClipperã€‚</p><p>KubeClipper åœ¨å®Œå…¨å…¼å®¹åŸç”Ÿ Kubernetes çš„å‰æä¸‹ï¼ŒåŸºäºç¤¾åŒºå¹¿æ³›ä½¿ç”¨çš„ kubeadm å·¥å…·è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæä¾›åœ¨ä¼ä¸šè‡ªæœ‰åŸºç¡€è®¾æ–½ä¸­å¿«é€Ÿéƒ¨ç½² kubernetes é›†ç¾¤å’ŒæŒç»­åŒ–å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆå®‰è£…ã€å¸è½½ã€å‡çº§ã€æ‰©ç¼©å®¹ã€è¿œç¨‹è®¿é—®ç­‰ï¼‰èƒ½åŠ›ï¼Œæ”¯æŒåœ¨çº¿ã€ä»£ç†ã€ç¦»çº¿ç­‰å¤šç§éƒ¨ç½²æ–¹å¼ï¼Œè¿˜æä¾›äº†ä¸°å¯Œå¯æ‰©å±•çš„ CRIã€CNIã€CSIã€ä»¥åŠå„ç±» CRD ç»„ä»¶çš„ç®¡ç†æœåŠ¡ã€‚</p><p>ä¸ç°æœ‰çš„ Sealosã€KubeKeyã€Kubeaszã€KubeOperatorã€K0S ç­‰ kubernetes ç”Ÿå‘½å‘¨æœŸç®¡ç†å·¥å…·ç›¸æ¯”ï¼ŒKubeClipper æ›´è´´è¿‘å¼€æ”¾åŸç”Ÿã€è½»é‡ä¾¿æ·ã€ç¨³å®šæ˜“ç”¨ã€‚</p><ul><li><a href=/docs/getting-started/>å¿«é€Ÿå¼€å§‹</a>: Learn how to get started with Kubeclipper</li><li><a href=/docs/tutorials>ç”¨æˆ·æ‰‹å†Œ</a>: Check out some example code!</li></ul><h2 id=kubeclipper-æ¶æ„è®¾è®¡>KubeClipper æ¶æ„è®¾è®¡</h2><h3 id=æ ¸å¿ƒæ¶æ„>æ ¸å¿ƒæ¶æ„</h3><p><img src=/images/docs-overview/kc-arch2.png alt></p><p>KubeClipper åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>kc-serverï¼šåŸåˆ™ä¸Šéƒ¨ç½²åœ¨ç‹¬ç«‹èŠ‚ç‚¹ï¼Œè´Ÿè´£æ”¶é›†èŠ‚ç‚¹ä¸ŠæŠ¥ä¿¡æ¯ï¼Œåˆ†å‘å‰ç«¯æ“ä½œä»»åŠ¡è‡³æŒ‡å®š kc-agent å¹¶æ±‡æ€»æ‰§è¡Œç»“æœç­‰ï¼Œæ˜¯ KubeClipper æ§åˆ¶æ ¸å¿ƒã€‚</li><li>kc-agent: éƒ¨ç½²åœ¨çº³ç®¡èŠ‚ç‚¹ï¼Œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå†…ç½® natsï¼‰ä¸ kc-server é€šä¿¡ï¼Œè´Ÿè´£ä¸ŠæŠ¥èŠ‚ç‚¹ä¿¡æ¯ä»¥åŠå¤„ç†ä¸‹å‘ä»»åŠ¡å¹¶æ‰§è¡Œï¼Œæ˜¯ KubeClipper èŠ‚ç‚¹ä»£ç†å·¥å…·ã€‚</li><li>kcctl: KubeClipper çš„ç»ˆç«¯å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯å¿«æ·é«˜æ•ˆçš„éƒ¨ç½²ã€ç®¡ç† KubeClipper é›†ç¾¤ï¼Œèƒ½å¤Ÿæ›¿ä»£å¤§å¤šæ•°é¡µé¢æ“ä½œã€‚</li></ul><h3 id=èŠ‚ç‚¹çº³ç®¡>èŠ‚ç‚¹çº³ç®¡</h3><p><img src=/images/docs-overview/kc-arch.png alt></p><h3 id=éƒ¨ç½²ç½‘ç»œæ¨¡å‹>éƒ¨ç½²ç½‘ç»œæ¨¡å‹</h3><p><img src=/images/docs-overview/kc-network.png alt></p><p>KubeClipper æ”¯æŒå¯ä»¥é€šè¿‡å‚æ•°é…ç½®æ¥éƒ¨ç½²åˆ†å±‚ç½‘ç»œæ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸åŒç½‘ç»œçš„æ¦‚è¦ï¼š</p><p>è¿ç»´ç®¡ç†ç½‘ç»œ(Management Network):<br>åœ¨ <code>kcctl deploy</code> éƒ¨ç½² KubeClipper é›†ç¾¤æ—¶ï¼Œå¯é€šè¿‡ <code>--ip-detect</code> å‚æ•°æŒ‡å®šç½‘å¡æ¥å£ï¼Œé»˜è®¤ä¸º <code>first-found</code>ã€‚
è¯¥ç½‘å¡æ¥å£å¯¹åº”çš„ IP åœ°å€å³æ˜¯ <code>kc-server</code> ä¸ <code>kc-agent</code> çš„è·¯ç”±åœ°å€ã€‚</p><p>K8S ä¸»æœºç½‘ç»œ(K8S Host Network):<br>åœ¨ <code>kcctl deploy</code> éƒ¨ç½² KubeClipper é›†ç¾¤æ—¶ï¼Œå¯é€šè¿‡ <code>--node-ip-detct</code> å‚æ•°æŒ‡å®šç½‘å¡æ¥å£ï¼Œé»˜è®¤ç»§æ‰¿ <code>--ip-detect</code> å‚æ•°å€¼ï¼Œäº¦å¯ç‹¬ç«‹è®¾ç½®ã€‚
è¯¥ç½‘å¡æ¥å£å¯¹åº”çš„ IP åœ°å€å³æ˜¯ K8S çš„èŠ‚ç‚¹è·¯ç”±åœ°å€ã€‚</p><p>K8S Pod ç½‘ç»œ(SDN Pod Network):<br>åœ¨å®‰è£… K8S é›†ç¾¤æ—¶ï¼Œå¯é€šè¿‡å¡«å…¥ CNI çš„ <code>POD ç½‘è·¯åº•å±‚</code> æŒ‡å®šç½‘å¡æ¥å£ï¼Œé»˜è®¤ä¸º <code>first-found</code>ã€‚
è¯¥ç½‘å¡æ¥å£å¯¹åº”çš„ IP åœ°å€å³æ˜¯ K8S POD ç½‘è·¯åº•å±‚çš„è·¯ç”±åœ°å€ã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-93aadc1aba179e6928539400a09b9e4e>2 - å¿«é€Ÿå¼€å§‹</h1><div class=lead>å¿«é€Ÿæ­å»ºä½“éªŒå¹³å°åŠŸèƒ½</div><p>å¯¹äºåˆæ¬¡æ¥è§¦ KubeClipper å¹¶æƒ³å¿«é€Ÿä¸Šæ‰‹çš„ç”¨æˆ·ï¼Œå»ºè®®ä½¿ç”¨ All-in-One å®‰è£…æ¨¡å¼ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æ‚¨é›¶é…ç½®å¿«é€Ÿéƒ¨ç½² KubeClipperã€‚</p><h3 id=å‡†å¤‡å·¥ä½œ>å‡†å¤‡å·¥ä½œ</h3><p>KubeClipper æœ¬èº«å¹¶ä¸ä¼šå ç”¨å¤ªå¤šèµ„æºï¼Œä½†æ˜¯ä¸ºäº†åç»­æ›´å¥½çš„è¿è¡Œ Kubernetes å»ºè®®ç¡¬ä»¶é…ç½®ä¸ä½äºæœ€ä½è¦æ±‚ã€‚</p><p>æ‚¨ä»…éœ€å‚è€ƒä»¥ä¸‹å¯¹æœºå™¨ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„è¦æ±‚å‡†å¤‡ä¸€å°ä¸»æœºã€‚</p><h4 id=ç¡¬ä»¶æ¨èé…ç½®>ç¡¬ä»¶æ¨èé…ç½®</h4><ul><li>ç¡®ä¿æ‚¨çš„æœºå™¨æ»¡è¶³æœ€ä½ç¡¬ä»¶è¦æ±‚ï¼šCPU >= 2 æ ¸ï¼Œå†…å­˜ >= 2GBã€‚</li><li>æ“ä½œç³»ç»Ÿï¼šCentOS 7.x / Ubuntu 18.04 / Ubuntu 20.04ã€‚</li></ul><h4 id=èŠ‚ç‚¹è¦æ±‚>èŠ‚ç‚¹è¦æ±‚</h4><ul><li>èŠ‚ç‚¹å¿…é¡»èƒ½å¤Ÿé€šè¿‡ <code>SSH</code> è¿æ¥ã€‚</li><li>èŠ‚ç‚¹ä¸Šå¯ä»¥ä½¿ç”¨ <code>sudo</code> / <code>curl</code> / <code>wget</code> / <code>tar</code> å‘½ä»¤ã€‚</li></ul><blockquote><p>å»ºè®®æ‚¨çš„æ“ä½œç³»ç»Ÿå¤„äºå¹²å‡€çŠ¶æ€ï¼ˆä¸å®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶ï¼‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚</p></blockquote><h3 id=éƒ¨ç½²-kubeclipper>éƒ¨ç½² KubeClipper</h3><h4 id=ä¸‹è½½-kcctl>ä¸‹è½½ kcctl</h4><p>KubeClipper æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ğŸ”§ kcctl ä»¥ç®€åŒ–è¿ç»´å·¥ä½œï¼Œæ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½æœ€æ–°ç‰ˆ kcctlï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh | bash -</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å¦‚æœä½ åœ¨ä¸­å›½ï¼Œ ä½ å¯ä»¥åœ¨å®‰è£…æ—¶ä½¿ç”¨ cn  ç¯å¢ƒå˜é‡, æ­¤æ—¶æˆ‘ä»¬ä¼šä½¿ç”¨ registry.aliyuncs.com/google_containers ä»£æ›¿ k8s.gcr.io</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_REGION</span><span style=color:#ce5c00;font-weight:700>=</span>cn bash -
</span></span></code></pre></div><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ <a href=https://github.com/kubeclipper/kubeclipper/releases>GitHub Release Page</a> ä¸‹è½½æŒ‡å®šç‰ˆæœ¬ã€‚</p></blockquote><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl version
</span></span></code></pre></div><h4 id=å¼€å§‹å®‰è£…>å¼€å§‹å®‰è£…</h4><p>åœ¨æœ¬å¿«é€Ÿå…¥é—¨æ•™ç¨‹ä¸­ï¼Œæ‚¨åªéœ€æ‰§è¡Œä¸€ä¸ªå‘½ä»¤å³å¯å®‰è£… KubeClipperï¼Œå…¶æ¨¡æ¿å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy
</span></span></code></pre></div><p>è‹¥ä½¿ç”¨ ssh passwd æ–¹å¼åˆ™å‘½ä»¤å¦‚ä¸‹æ‰€ç¤º:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --user root --passwd <span style=color:#000>$SSH_PASSWD</span>
</span></span></code></pre></div><p>ç§é’¥æ–¹å¼å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --user root --pk-file <span style=color:#000>$SSH_PRIVATE_KEY</span>
</span></span></code></pre></div><blockquote><p>æ‚¨åªéœ€è¦æä¾› ssh user ä»¥åŠ ssh passwd æˆ–è€… ssh ç§é’¥å³å¯åœ¨æœ¬æœºéƒ¨ç½² KubeClipperã€‚</p></blockquote><p>æ‰§è¡Œè¯¥å‘½ä»¤åï¼ŒKcctl å°†æ£€æŸ¥æ‚¨çš„å®‰è£…ç¯å¢ƒï¼Œè‹¥æ»¡è¶³æ¡ä»¶å°†ä¼šè¿›å…¥å®‰è£…æµç¨‹ã€‚åœ¨æ‰“å°å‡ºå¦‚ä¸‹çš„ KubeClipper banner åå³è¡¨ç¤ºå®‰è£…å®Œæˆã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#000;font-style:italic> _   __      _          _____ _ _
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| | / /     | |        /  __ \ (_)
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| |/ / _   _| |__   ___| /  \/ |_ _ __  _ __   ___ _ __
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>|    \| | | | &#39;_ \ / _ \ |   | | | &#39;_ \| &#39;_ \ / _ \ &#39;__|
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| |\  \ |_| | |_) |  __/ \__/\ | | |_) | |_) |  __/ |
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>\_| \_/\__,_|_.__/ \___|\____/_|_| .__/| .__/ \___|_|
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>                                 | |   | |
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>                                 |_|   |_|
</span></span></span></code></pre></div><h3 id=ç™»å½•æ§åˆ¶å°>ç™»å½•æ§åˆ¶å°</h3><p>å®‰è£…å®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://$IP</code> å³å¯è¿›å…¥ KubeClipper æ§åˆ¶å°ã€‚</p><p><img src=/images/docs-quickstart/console-login.png alt=console></p><p>æ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤å¸å·å¯†ç  <code>admin / Thinkbig1</code> è¿›è¡Œç™»å½•ã€‚</p><blockquote><p>æ‚¨å¯èƒ½éœ€è¦é…ç½®ç«¯å£è½¬å‘è§„åˆ™å¹¶åœ¨å®‰å…¨ç»„ä¸­å¼€æ”¾ç«¯å£ï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·è®¿é—®æ§åˆ¶å°ã€‚</p></blockquote><h3 id=åˆ›å»º-kubernetes-é›†ç¾¤>åˆ›å»º kubernetes é›†ç¾¤</h3><p>éƒ¨ç½²æˆåŠŸåæ‚¨å¯ä»¥ä½¿ç”¨ <strong>kcctl å·¥å…·</strong>æˆ–è€…é€šè¿‡<strong>æ§åˆ¶å°</strong>åˆ›å»º kubernetes é›†ç¾¤ã€‚åœ¨æœ¬å¿«é€Ÿå…¥é—¨æ•™ç¨‹ä¸­ä½¿ç”¨ kcctl å·¥å…·è¿›è¡Œåˆ›å»ºã€‚</p><p>é¦–å…ˆä½¿ç”¨é»˜è®¤å¸å·å¯†ç è¿›è¡Œç™»å½•è·å– tokenï¼Œä¾¿äºåç»­ kcctl å’Œ kc-server è¿›è¡Œäº¤äº’ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl login -H http://localhost -u admin -p Thinkbig1
</span></span></code></pre></div><p>ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º kubernetes é›†ç¾¤:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>NODE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>kcctl get node -o yaml<span style=color:#000;font-weight:700>|</span>grep ipv4DefaultIP:<span style=color:#000;font-weight:700>|</span>sed <span style=color:#4e9a06>&#39;s/ipv4DefaultIP: //&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kcctl create cluster --master <span style=color:#000>$NODE</span> --name demo --untaint-master
</span></span></code></pre></div><p>å¤§æ¦‚ 3 åˆ†é’Ÿå·¦å³å³å¯å®Œæˆé›†ç¾¤åˆ›å»º,ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl get cluster -o yaml<span style=color:#000;font-weight:700>|</span>grep status -A5
</span></span></code></pre></div><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥è¿›å…¥æ§åˆ¶å°æŸ¥çœ‹å®æ—¶æ—¥å¿—ã€‚</p></blockquote><p>è¿›å…¥ Running çŠ¶æ€å³è¡¨ç¤ºé›†ç¾¤å®‰è£…å®Œæˆ,æ‚¨å¯ä»¥ä½¿ç”¨ <code>kubectl get cs</code> å‘½ä»¤æ¥æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶å†µã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-51e07dd308860dc8b1808e7299ac75d8>2.1 - éƒ¨ç½² AIO</h1><div class=lead>éƒ¨ç½² AIO ç¯å¢ƒ</div><p>å¯¹äºåˆæ¬¡æ¥è§¦ KubeClipper å¹¶æƒ³å¿«é€Ÿä¸Šæ‰‹çš„ç”¨æˆ·ï¼Œå»ºè®®ä½¿ç”¨ AIOï¼ˆå³ All-in-Oneï¼Œä½¿ç”¨å•ä¸ªèŠ‚ç‚¹å®‰è£… KubeClipperï¼‰æ¨¡å¼ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æ‚¨é›¶é…ç½®å¿«é€Ÿéƒ¨ç½² KubeClipperã€‚</p><h2 id=éƒ¨ç½²-kubeclipper>éƒ¨ç½² KubeClipper</h2><h3 id=ä¸‹è½½å¹¶å®‰è£…-kcctl>ä¸‹è½½å¹¶å®‰è£… kcctl</h3><p>KubeClipper æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ğŸ”§ kcctl ä»¥ç®€åŒ–è¿ç»´å·¥ä½œï¼Œæ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½æœ€æ–°ç‰ˆ kcctlï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># é»˜è®¤å®‰è£…æœ€æ–°çš„å‘è¡Œç‰ˆ</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> bash -
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å®‰è£…æŒ‡å®šç‰ˆæœ¬</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>v1.3.1 bash -
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å¦‚æœæ‚¨åœ¨ä¸­å›½ï¼Œ æ‚¨å¯ä»¥åœ¨å®‰è£…æ—¶ä½¿ç”¨ cn  ç¯å¢ƒå˜é‡, æ­¤æ—¶ KubeClipper ä¼šä½¿ç”¨ registry.aliyuncs.com/google_containers ä»£æ›¿ k8s.gcr.io</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_REGION</span><span style=color:#ce5c00;font-weight:700>=</span>cn bash -
</span></span></code></pre></div><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ <a href=https://github.com/kubeclipper/kubeclipper/releases>GitHub Release Page</a> ä¸‹è½½æŒ‡å®šç‰ˆæœ¬ã€‚</p></blockquote><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯ kcctl æ˜¯å¦å®‰è£…æˆåŠŸ:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨å°†çœ‹åˆ° kcctl ç‰ˆæœ¬ä¿¡æ¯</span>
</span></span><span style=display:flex><span>kcctl version
</span></span></code></pre></div><h3 id=å¼€å§‹å®‰è£…>å¼€å§‹å®‰è£…</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>kcctl deploy</code> å¿«é€Ÿå®‰è£…éƒ¨ç½² KubeClipperã€‚kcctl ä½¿ç”¨ SSH è®¿é—®æœ€ç»ˆéƒ¨ç½² KubeClipper çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦æ‚¨æä¾› SSH è®¿é—®å‡­è¯ï¼Œä¼ é€’å‡­è¯çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Kcctl deploy <span style=color:#ce5c00;font-weight:700>[</span>--user &lt;username&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>--passwd &lt;password&gt; <span style=color:#000;font-weight:700>|</span> --pk-file &lt;private key path&gt;<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div><p>ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ä½¿ç”¨ç§é’¥</span>
</span></span><span style=display:flex><span>kcctl deploy --user root --pk-file /root/.ssh/id_rsa
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ä½¿ç”¨å¯†ç </span>
</span></span><span style=display:flex><span>kcctl deploy --user root --passwd password
</span></span></code></pre></div><p>æ‰§è¡Œ <code>kcctl deploy</code> å‘½ä»¤ kcctl å°†ä¼šæ£€æŸ¥æ‚¨çš„å®‰è£…ç¯å¢ƒï¼Œè‹¥æ»¡è¶³æ¡ä»¶å°†è‡ªåŠ¨è¿›å…¥å®‰è£…æµç¨‹ã€‚è‹¥æ‚¨çœ‹åˆ°å¦‚ä¸‹ KubeClipper banner åå³è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#000;font-style:italic> _   __      _          _____ _ _
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| | / /     | |        /  __ \ (_)
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| |/ / _   _| |__   ___| /  \/ |_ _ __  _ __   ___ _ __
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>|    \| | | | &#39;_ \ / _ \ |   | | | &#39;_ \| &#39;_ \ / _ \ &#39;__|
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>| |\  \ |_| | |_) |  __/ \__/\ | | |_) | |_) |  __/ |
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>\_| \_/\__,_|_.__/ \___|\____/_|_| .__/| .__/ \___|_|
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>                                 | |   | |
</span></span></span><span style=display:flex><span><span style=color:#000;font-style:italic>                                 |_|   |_|
</span></span></span></code></pre></div><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥éƒ¨ç½² master ç‰ˆæœ¬çš„ KubeClipperï¼Œæ¥ä½“éªŒæœ€æ–°çš„åŠŸèƒ½ç‰¹æ€§ï¼ˆmaster ç‰ˆæœ¬æ²¡æœ‰ç»è¿‡ä¸¥æ ¼éªŒè¯ï¼Œå¯èƒ½åŒ…å«å½±å“ä½“éªŒçš„æœªçŸ¥é”™è¯¯ï¼‰</p><ol><li>å®‰è£… master ç‰ˆæœ¬ kcctl</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>master bash -
</span></span></code></pre></div><ol start=2><li>åœ¨å®‰è£…æœåŠ¡å™¨ä¸Šè®¾ç½®ç¯å¢ƒå˜é‡</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>KC_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>master
</span></span></code></pre></div><ol start=3><li>ä»¥ AIO æ–¹å¼éƒ¨ç½² KubeClipper</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy
</span></span></code></pre></div></blockquote><h3 id=ç™»å½•æ§åˆ¶å°>ç™»å½•æ§åˆ¶å°</h3><p>å®‰è£…å®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://&lt;kc-server ip address></code> å³å¯è¿›å…¥ KubeClipper æ§åˆ¶å°ã€‚(é€šå¸¸ kc-server ip æ˜¯æ‚¨éƒ¨ç½² kubeClipper èŠ‚ç‚¹çš„ ip)</p><p><img src=/images/docs-quickstart/console-login.png alt=console></p><p>æ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤å¸å·å¯†ç  <code>admin / Thinkbig1</code> è¿›è¡Œç™»å½•ã€‚</p><blockquote><p>æ‚¨å¯èƒ½éœ€è¦é…ç½®ç«¯å£è½¬å‘è§„åˆ™å¹¶åœ¨å®‰å…¨ç»„ä¸­å¼€æ”¾ç«¯å£ï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·è®¿é—®æ§åˆ¶å°ã€‚</p></blockquote><h2 id=åˆ›å»º-kubernetes-é›†ç¾¤>åˆ›å»º Kubernetes é›†ç¾¤</h2><p>éƒ¨ç½²æˆåŠŸåæ‚¨å¯ä»¥ä½¿ç”¨ <strong>kcctl å·¥å…·</strong>æˆ–è€…é€šè¿‡<strong>æ§åˆ¶å°</strong>åˆ›å»º Kubernetes é›†ç¾¤ã€‚åœ¨æœ¬å¿«é€Ÿå…¥é—¨æ•™ç¨‹ä¸­ä½¿ç”¨ kcctl å·¥å…·è¿›è¡Œåˆ›å»ºã€‚</p><p>é¦–å…ˆä½¿ç”¨é»˜è®¤å¸å·å¯†ç è¿›è¡Œç™»å½•è·å– tokenï¼Œä¾¿äºåç»­ kcctl å’Œ kc-server è¿›è¡Œäº¤äº’ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl login -H https://&lt;kc-server ip address&gt;:8080 -u admin -p Thinkbig1
</span></span></code></pre></div><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»º Kubernetes é›†ç¾¤:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>NODE</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>kcctl get node -o yaml<span style=color:#000;font-weight:700>|</span>grep ipv4DefaultIP:<span style=color:#000;font-weight:700>|</span>sed <span style=color:#4e9a06>&#39;s/ipv4DefaultIP: //&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kcctl create cluster --master <span style=color:#000>$NODE</span> --name demo --untaint-master
</span></span></code></pre></div><p>å¤§æ¦‚ 3 åˆ†é’Ÿå·¦å³å³å¯å®Œæˆé›†ç¾¤åˆ›å»º,æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl get cluster -o yaml<span style=color:#000;font-weight:700>|</span>grep status -A5
</span></span></code></pre></div><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥è¿›å…¥æ§åˆ¶å°æŸ¥çœ‹å®æ—¶æ—¥å¿—ã€‚</p></blockquote><p>é›†ç¾¤å¤„äº Running çŠ¶æ€å³è¡¨ç¤ºé›†ç¾¤å®‰è£…å®Œæˆ,æ‚¨å¯ä»¥ä½¿ç”¨ <code>kubectl get cs</code> å‘½ä»¤æ¥æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶å†µã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-45c14578741098628f1d483b1891e15d>2.2 - ä½¿ç”¨ Kubeclipper ç¦»çº¿åˆ›å»º kubernetes é›†ç¾¤</h1><div class=lead>å¦‚ä½•ä½¿ç”¨ KC å¹³å°ç¦»çº¿åˆ›å»º kubernetes é›†ç¾¤</div><h2 id=1-è¿›å…¥åˆ›å»ºç•Œé¢>1. è¿›å…¥åˆ›å»ºç•Œé¢</h2><p>ç™»å½• Kubeclipper å¹³å°åç‚¹å‡»å¦‚å›¾æ‰€ç¤ºæŒ‰é’®ï¼Œè¿›å…¥é›†ç¾¤åˆ›å»ºç•Œé¢</p><p><img src=/images/docs-quickstart/cluster-begin.png alt></p><h2 id=2-é…ç½®é›†ç¾¤èŠ‚ç‚¹>2. é…ç½®é›†ç¾¤èŠ‚ç‚¹</h2><p>æŒ‰ç…§æ–‡å­—æç¤ºå®Œæˆè¾“å…¥é›†ç¾¤åç§°ã€é€‰æ‹©èŠ‚ç‚¹ç­‰æ­¥éª¤</p><p>æ³¨æ„: master èŠ‚ç‚¹æ•°é‡ä¸èƒ½ä¸ºå¶æ•°</p><p><img src=/images/docs-quickstart/cluster-node-config.png alt></p><h2 id=3-é…ç½®é›†ç¾¤>3. é…ç½®é›†ç¾¤</h2><p>æ­¤æ­¥éª¤ç”¨äºé…ç½®é›†ç¾¤ç½‘ç»œä»¥åŠæ•°æ®åº“ã€å®¹å™¨è¿è¡Œæ—¶ç­‰ç»„ä»¶</p><p>é€‰æ‹©ç¦»çº¿å®‰è£…å¹¶å¡«å†™é¦–å…ˆæ­å»ºå¥½çš„é•œåƒä»“åº“åœ°å€</p><p><img src=/images/docs-quickstart/cluster-config.png alt></p><h2 id=4-é…ç½®å­˜å‚¨>4. é…ç½®å­˜å‚¨</h2><p>é€‰æ‹© nfs å­˜å‚¨ï¼ŒæŒ‰ç…§æ–‡å­—æç¤ºå¡«å†™ç›¸åº”å†…å®¹</p><p><img src=/images/docs-quickstart/cluster-storage-config.png alt></p><h2 id=5-å®‰è£…å®Œæˆ>5. å®‰è£…å®Œæˆ</h2><p>å®Œæˆæ‰€æœ‰é…ç½®ç¡®è®¤å®‰è£…</p><p><img src=/images/docs-quickstart/cluster-finish.png alt></p><p>å®‰è£…æˆåŠŸï¼Œé›†ç¾¤æ­£å¸¸è¿è¡Œ</p><p><img src=/images/docs-quickstart/cluster-successful.png alt></p></div><div class=td-content style=page-break-before:always><h1 id=pg-a07813ac798dd2637717ce2e67c448bd>3 - éƒ¨ç½²æ–‡æ¡£</h1><div class=lead>éƒ¨ç½²ç¤ºä¾‹</div></div><div class=td-content><h1 id=pg-1ed184c63a9ba32659457db911ea314c>3.1 - éƒ¨ç½²é«˜å¯ç”¨ KubeClipper</h1><div class=lead>å¿«é€Ÿéƒ¨ç½²é«˜å¯ç”¨ã€ç”Ÿäº§å°±ç»ªçš„ KubeClipper é›†ç¾¤</div><blockquote><p>å¯¹äºåˆæ¬¡æ¥è§¦ KubeClipperï¼Œå»ºè®®éƒ¨ç½² AIO ç¯å¢ƒï¼Œå¿«é€Ÿä¸Šæ‰‹ä½“éªŒ KubeClipper æä¾›çš„åŠŸèƒ½ç‰¹æ€§ã€‚
å¯¹äºæƒ³å°† KubeClipper åº”ç”¨åˆ°ç”Ÿæˆç¯å¢ƒï¼Œé‚£ä¹ˆæœ¬æ–‡æ¡£æˆ–è®¸å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚</p></blockquote><h2 id=æ¦‚è¿°>æ¦‚è¿°</h2><p>æ ¹æ® KubeClipper æ¶æ„è®¾è®¡å¯çŸ¥ï¼ŒKubeClipper æœ‰ä»¥ä¸‹ 4 ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p><ul><li>kc-serverï¼šä¸»è¦åŒ…æ‹¬ APISERVER ã€æ§åˆ¶å™¨ã€é™æ€èµ„æºæœåŠ¡ä»¥åŠå†…ç½®æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼Œkc-server é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæ”¯æŒå¤–ç½®ï¼‰ä¸ kc-agent é€šä¿¡ï¼›kc-server ä¹‹é—´æ— ä¸»ä»å…³ç³»ï¼Œä¸”ç›¸äº’ç‹¬ç«‹ï¼›é€šå¸¸éƒ¨ç½²åœ¨ç‹¬ç«‹çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å¤–æä¾›ç¨³å®šå¯é çš„æœåŠ¡ã€‚</li><li>kc-agentï¼šä¸»è¦åŒ…æ‹¬ä»»åŠ¡å¤„ç†å™¨ï¼Œè´Ÿè´£æ¥æ”¶ kc-server æŠ•é€’çš„ä»»åŠ¡ï¼Œå¹¶åé¦ˆä»»åŠ¡å¤„ç†ç»“æœï¼›é€šå¸¸éƒ¨ç½²åœ¨éœ€è¦å®‰è£… kubernetes çš„èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªè¶…è½»é‡çº§çš„æœåŠ¡è¿›ç¨‹ã€‚</li><li>kc-etcdï¼škc-server çš„åç«¯æ•°æ®åº“ï¼Œè·Ÿéš kc-server éƒ¨ç½²åœ¨åŒä¸€èŠ‚ç‚¹ä¸Šã€‚</li><li>kc-dashboardï¼šå›¾å½¢åŒ–ç®¡ç†ç•Œé¢ï¼Œè·Ÿéš kc-server éƒ¨ç½²åœ¨åŒä¸€èŠ‚ç‚¹ã€‚
ç»¼ä¸Šï¼Œæˆ‘ä»¬å°†éƒ¨ç½² kc-server çš„èŠ‚ç‚¹ç§°ä¸º serverï¼Œéƒ¨ç½² kc-agent çš„èŠ‚ç‚¹ç§°ä¸º agentã€‚</li></ul><p>é‚£ä¹ˆéƒ¨ç½²é«˜å¯ç”¨ KubeClipper é›†ç¾¤çš„å…³é”®ç‚¹ï¼Œå°±åœ¨äºå¦‚ä½•è§„åˆ’éƒ¨ç½² server èŠ‚ç‚¹åŒæ—¶ä¿è¯ kc-etcd çš„é«˜å¯ç”¨ã€‚
é€šå¸¸æ¥çœ‹ï¼Œå¯¹äºéƒ¨ç½²é«˜å¯ç”¨çš„åˆ†å¸ƒå¼åº”ç”¨é›†ç¾¤ï¼ŒåŸºæœ¬å»ºè®®èŠ‚ç‚¹è‡³å°‘ 3 ä¸ªï¼›åŒæ ·å¯¹äº KubeClipperï¼Œ3 ä¸ªèŠ‚ç‚¹èƒ½ä¿è¯ kc-server åœ¨å…¶ä¸­ 2 ä¸ªèŠ‚ç‚¹å®•æœºåä¾æ—§å¯ä»¥æä¾›æœåŠ¡ï¼ŒåŒæ—¶èƒ½ä¿è¯ kc-etcd ä¸ä¼šå‡ºç°è„‘è£‚å¼‚å¸¸ã€‚</p><blockquote><p>ä»¥ä¸Šç®€å•ä»‹ç»äº† KubeClipper æ¶æ„ä»¥åŠæ ¸å¿ƒç»„ä»¶ï¼Œæ˜¯ä¸ºäº†æ›´å¥½çš„ç†è§£è¯¥å¦‚ä½•éƒ¨ç½²é«˜å¯ç”¨ KubeClipper é›†ç¾¤ï¼Œä»è€Œå¼•å‡ºå…³äºå¯¹æœåŠ¡å™¨èŠ‚ç‚¹è§„åˆ’ä»¥åŠç¡¬ä»¶é…ç½®è¦æ±‚çš„æ€è€ƒã€‚</p></blockquote><h2 id=æ¨èé…ç½®>æ¨èé…ç½®</h2><blockquote><p>KubeClipper ä½œä¸ºä¸€ä¸ªæè½»é‡çš„ Kubernetes å¤šé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†å·¥å…·ï¼Œæœ¬èº«ä¸ä¼šå ç”¨å¤ªå¤šèµ„æº</p></blockquote><p>server èŠ‚ç‚¹</p><ul><li>æ•°é‡ï¼š3 ä¸ªåŠä»¥ä¸Š</li><li>ç¡¬ä»¶è¦æ±‚ï¼šCPU >= 2 æ ¸ï¼Œå†…å­˜ >= 2GBï¼Œç¡¬ç›˜ >= 20GB</li><li>ç³»ç»Ÿï¼šCentOS 7.x / Ubuntu 18.04 / Ubuntu 20.04</li></ul><p>agent èŠ‚ç‚¹</p><ul><li>æ•°é‡ï¼šä»»æ„</li><li>ç¡¬ä»¶è¦æ±‚ï¼šä¾æ®å®é™…éœ€æ±‚è€Œå®š</li><li>ç³»ç»Ÿï¼šCentOS 7.x / Ubuntu 18.04 / Ubuntu 20.04</li></ul><h2 id=ä»å®‰è£…-kcctl-å¼€å§‹>ä»å®‰è£… kcctl å¼€å§‹</h2><blockquote><p>kcctl æ˜¯ KubeClipper æä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒæ”¯æŒå¿«é€Ÿéƒ¨ç½² KubeClipper é›†ç¾¤ä»¥åŠå¤§éƒ¨åˆ† Kuberneters é›†ç¾¤ç®¡ç†åŠŸèƒ½ï¼Œç”¨ä»¥ç®€åŒ–è¿ç»´å·¥ä½œã€‚</p></blockquote><p>å®‰è£… kcctlï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># é»˜è®¤å®‰è£…æœ€æ–°å‘è¡Œç‰ˆ</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> bash -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å®‰è£…æŒ‡å®šç‰ˆæœ¬</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>v1.3.1 bash -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å¦‚æœæ‚¨åœ¨ä¸­å›½ï¼Œæ‚¨å¯ä»¥åœ¨å®‰è£…æ—¶æŒ‡å®š KC_REGION ç¯å¢ƒå˜é‡ï¼Œæ­¤æ—¶æˆ‘ä»¬ä¼šä½¿ç”¨ registry.aliyuncs.com/google_containers ä»£æ›¿ k8s.gcr.io</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># è¿™å¯¹äºåœ¨çº¿å®‰è£… k8s é›†ç¾¤éå¸¸æœ‰ç”¨</span>
</span></span><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_REGION</span><span style=color:#ce5c00;font-weight:700>=</span>cn bash -
</span></span></code></pre></div><p>å®‰è£…æˆåŠŸåï¼Œä¼šè¾“å‡ºå®‰è£…ç‰ˆæœ¬ä»¥åŠå®‰è£…è·¯å¾„ç­‰ä¿¡æ¯ã€‚</p><blockquote><p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ <a href=https://github.com/kubeclipper/kubeclipper/releases>GitHub Release Page</a> ä¸‹è½½æŒ‡å®šçš„ kcctl ç‰ˆæœ¬</p></blockquote><p>éªŒè¯å®‰è£…ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl version -o json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kcctl version:
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;major&#34;</span>: <span style=color:#4e9a06>&#34;1&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;minor&#34;</span>: <span style=color:#4e9a06>&#34;3&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;gitVersion&#34;</span>: <span style=color:#4e9a06>&#34;v1.3.1&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;gitCommit&#34;</span>: <span style=color:#4e9a06>&#34;5f19dcf78d3a9dc2d1035a779152fa993e0553df&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;gitTreeState&#34;</span>: <span style=color:#4e9a06>&#34;clean&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;buildDate&#34;</span>: <span style=color:#4e9a06>&#34;2022-12-02T10:12:36Z&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;goVersion&#34;</span>: <span style=color:#4e9a06>&#34;go1.19.2&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;compiler&#34;</span>: <span style=color:#4e9a06>&#34;gc&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;platform&#34;</span>: <span style=color:#4e9a06>&#34;linux/amd64&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</span>
</span></span><span style=display:flex><span>kcctl -h
</span></span></code></pre></div><h2 id=äº†è§£-kcctl-deploy-å‘½ä»¤>äº†è§£ kcctl deploy å‘½ä»¤</h2><blockquote><p>kcctl deploy å‘½ä»¤æ˜¯ä¸“é—¨ç”¨äºéƒ¨ç½² KubeClipper é›†ç¾¤ï¼Œæ›´å¤šç¤ºä¾‹ä»¥åŠå‚æ•°è§£é‡Šè¯·æ‰§è¡Œ kcctl deploy -h</p></blockquote><p>å¸¸ç”¨å‚æ•°ç®€ä»‹</p><ul><li>&ndash;server: server èŠ‚ç‚¹ IPï¼Œä¾‹å¦‚ 192.168.10.10,192.168.10.11ï¼Œå¤šä¸ª IP ä»¥é€—å·éš”å¼€ã€‚</li><li>&ndash;agent: agent èŠ‚ç‚¹ IPï¼Œä¾‹å¦‚ 192.168.10.10,192.168.10.11ï¼Œå¤šä¸ª IP ä»¥é€—å·éš”å¼€ã€‚</li><li>&ndash;pk-file: ssh å…å¯†ç™»å½•ç§é’¥ï¼Œæ¨èåœ¨å‘½ä»¤è¡Œä½¿ç”¨å…å¯†ç™»å½•ã€‚</li><li>&ndash;user: ssh ç™»å½•ç”¨æˆ·åï¼Œé»˜è®¤ä¸º rootã€‚</li><li>&ndash;passwd: ssh ç™»å½•å¯†ç ï¼Œä¸æ¨èåœ¨å‘½ä»¤è¡Œä½¿ç”¨å¯†ç ç™»å½•ã€‚</li><li>&ndash;pkg: å®‰è£…åŒ…è·¯å¾„ï¼Œæ”¯æŒæœ¬åœ°è·¯å¾„ä»¥åŠåœ¨çº¿é“¾æ¥ï¼›è·å–åœ¨çº¿å®‰è£…åŒ…é“¾æ¥è§„åˆ™ï¼šhttps://oss.kubeclipper.io/release/{KC_VERSION}/kc-{GOARCH}.tar.gz ã€‚KC_VERSION ä¸º Release Version é»˜è®¤è®¾ç½®å½“å‰ kcctl å¯¹åº”ç‰ˆæœ¬ï¼ŒGOARCH ä¸º amd64 æˆ– arm64ï¼Œé»˜è®¤è®¾ç½®å½“å‰ kcctl çš„ç¼–è¯‘æ¶æ„ã€‚</li><li>&ndash;ip-detect: èŠ‚ç‚¹ ip å‘ç°è§„åˆ™ï¼Œæ”¯æŒå¤šç§è§„åˆ™ï¼Œä¾‹å¦‚æŒ‡å®šç½‘å¡åç§°ç­‰ï¼Œå¯¹äºå¤šç½‘å¡èŠ‚ç‚¹éå¸¸æœ‰ç”¨ï¼Œé»˜è®¤ä¸º &ldquo;first-found&rdquo;ã€‚</li></ul><p>äº†è§£å®Œ kcctl deploy çš„åŸºç¡€ä½¿ç”¨ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±å¼€å§‹éƒ¨ç½² KubeClipper é›†ç¾¤å§ã€‚</p><h2 id=ä½¿ç”¨-kcctl-éƒ¨ç½²-kubeclipper>ä½¿ç”¨ kcctl éƒ¨ç½² KubeClipper</h2><blockquote><p>æˆ‘ä»¬æ¨èåœ¨å¤šèŠ‚ç‚¹å®‰è£…åœºæ™¯ä¸­ï¼Œå°†æ¶‰åŠåˆ°çš„æœåŠ¡å™¨èŠ‚ç‚¹éƒ½ç»Ÿä¸€è®¾ç½®å…å¯†ç™»å½•ï¼Œé¿å…å¯†ç æ˜æ–‡æ³„éœ²ã€‚</p></blockquote><p>ç§é’¥æ–¹å¼éƒ¨ç½² 3 server èŠ‚ç‚¹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --pk-file<span style=color:#ce5c00;font-weight:700>=</span>~/.ssh/id_rsa <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--server SERVER_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--pkg https://oss.kubeclipper.io/release/<span style=color:#ce5c00;font-weight:700>{</span>KC_VERSION<span style=color:#ce5c00;font-weight:700>}</span>/kc-<span style=color:#ce5c00;font-weight:700>{</span>GOARCH<span style=color:#ce5c00;font-weight:700>}</span>.tar.gz
</span></span></code></pre></div><p>ç§é’¥æ–¹å¼éƒ¨ç½² 3 server + 3 agent èŠ‚ç‚¹ï¼ŒæŒ‡å®š pkgï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --pk-file<span style=color:#ce5c00;font-weight:700>=</span>~/.ssh/id_rsa <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--server SERVER_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--agent AGENT_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--pkg https://oss.kubeclipper.io/release/<span style=color:#ce5c00;font-weight:700>{</span>KC_VERSION<span style=color:#ce5c00;font-weight:700>}</span>/kc-<span style=color:#ce5c00;font-weight:700>{</span>GOARCH<span style=color:#ce5c00;font-weight:700>}</span>.tar.gz
</span></span></code></pre></div><p>ç§é’¥æ–¹å¼éƒ¨ç½² 3 server + 3 agent èŠ‚ç‚¹ï¼ŒæœªæŒ‡å®š pkgï¼Œé»˜è®¤ä¸ kcctl å®‰è£…ç‰ˆæœ¬ä¸€è‡´ï¼ˆæ¨èï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --pk-file<span style=color:#ce5c00;font-weight:700>=</span>~/.ssh/id_rsa <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--server SERVER_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--agent AGENT_IPS
</span></span></code></pre></div><p>ç§é’¥æ–¹å¼éƒ¨ç½² 3 server + 3 agent èŠ‚ç‚¹ï¼ŒæŒ‡å®š etcd ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º client-12379 | peer-12380 | metrics-12381ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl deploy --pk-file<span style=color:#ce5c00;font-weight:700>=</span>~/.ssh/id_rsa <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--server SERVER_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--agent AGENT_IPS <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span>--etcd-port <span style=color:#0000cf;font-weight:700>12379</span> --etcd-peer-port <span style=color:#0000cf;font-weight:700>12380</span> --etcd-metric-port <span style=color:#0000cf;font-weight:700>12381</span>
</span></span></code></pre></div><blockquote><p>å‚æ•°è¾“å…¥ç¤ºä¾‹ï¼š<br>SERVER_IPS: 192.168.10.20,192.168.10.21<br>AGENT_IPS: 192.168.10.30,192.168.10.31<br>KC_VERSION: KubeClipper çš„ release versionï¼ŒæŸ¥çœ‹ <a href=https://github.com/kubeclipper/kubeclipper/releases>GitHub Release Page</a> è·å–<br>GOARCHï¼šç³»ç»Ÿæ¶æ„ï¼Œamd64 ï¼ˆåˆå x84_64ï¼‰ï¼Œarm64ï¼ˆåˆå aarch64ï¼‰</p></blockquote><p>kcctl deploy æ”¯æŒå¤šç§å‚æ•°ï¼Œèƒ½å¤Ÿæ»¡è¶³æ‚¨å¯¹éƒ¨ç½² KubeClipper é›†ç¾¤çš„ç‰¹å®šéœ€æ±‚ï¼Œæ›´å¤šåŠŸèƒ½ç­‰æ‚¨æ¢ç´¢ã€‚<br>åœ¨æ‰§è¡Œ kcctl deploy å‘½ä»¤åï¼Œå‘½ä»¤ä¼šæ£€æµ‹æ‚¨çš„ç¯å¢ƒæ˜¯å¦ç¬¦åˆå®‰è£…è¦æ±‚ï¼Œä¼šå°†è­¦å‘Šä¿¡æ¯ã€å®‰è£…è¿›åº¦ç­‰åŒæ­¥è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œæœ€ååœ¨å®‰è£…æˆåŠŸåä¼šæ‰“å°å¦‚ä¸‹ KubeClipper bannerï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> _   __      _          _____ _ _
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span> / /     <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>        /  __ <span style=color:#4e9a06>\ </span><span style=color:#ce5c00;font-weight:700>(</span>_<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>/ / _   _<span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>__   ___<span style=color:#000;font-weight:700>|</span> /  <span style=color:#4e9a06>\/</span> <span style=color:#000;font-weight:700>|</span>_ _ __  _ __   ___ _ __
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>|</span>    <span style=color:#4e9a06>\|</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>&#39;_ \ / _ \ |   | | | &#39;</span>_ <span style=color:#4e9a06>\|</span> <span style=color:#4e9a06>&#39;_ \ / _ \ &#39;</span>__<span style=color:#000;font-weight:700>|</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span><span style=color:#4e9a06>\ </span> <span style=color:#4e9a06>\ </span><span style=color:#000;font-weight:700>|</span>_<span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>_<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000;font-weight:700>|</span>  __/ <span style=color:#4e9a06>\_</span>_/<span style=color:#4e9a06>\ </span><span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>_<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>_<span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000;font-weight:700>|</span>  __/ <span style=color:#000;font-weight:700>|</span>
</span></span><span style=display:flex><span><span style=color:#4e9a06>\_</span><span style=color:#000;font-weight:700>|</span> <span style=color:#4e9a06>\_</span>/<span style=color:#4e9a06>\_</span>_,_<span style=color:#000;font-weight:700>|</span>_.__/ <span style=color:#4e9a06>\_</span>__<span style=color:#000;font-weight:700>|</span><span style=color:#4e9a06>\_</span>___/_<span style=color:#000;font-weight:700>|</span>_<span style=color:#000;font-weight:700>|</span> .__/<span style=color:#000;font-weight:700>|</span> .__/ <span style=color:#4e9a06>\_</span>__<span style=color:#000;font-weight:700>|</span>_<span style=color:#000;font-weight:700>|</span>
</span></span><span style=display:flex><span>                                 <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>   <span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>
</span></span><span style=display:flex><span>                                 <span style=color:#000;font-weight:700>|</span>_<span style=color:#000;font-weight:700>|</span>   <span style=color:#000;font-weight:700>|</span>_<span style=color:#000;font-weight:700>|</span>
</span></span></code></pre></div><p>ç³»ç»Ÿé»˜è®¤ç®¡ç†è´¦å·ï¼š<code>admin / Thinkbig1</code></p><p>ç™»å½•æ§åˆ¶å°ï¼š
æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://SERVER_IP</code> ï¼ˆé€šè¿‡ä»»æ„ä¸€ä¸ª Server èŠ‚ç‚¹å‡å¯è®¿é—®ï¼‰å³å¯è¿›å…¥ KubeClipper æ§åˆ¶å°</p><p><img src=/images/docs-quickstart/console-login.png alt=console></p><p>ç™»å½•å‘½ä»¤è¡Œï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl login -H http://SERVER_IP -u admin -p Thinkbig1
</span></span></code></pre></div><blockquote><p>å¤§å¤šæ•° kcctl å‘½ä»¤éƒ½ä¾èµ–ç™»å½•çŠ¶æ€ï¼Œå› æ­¤æœ€å¥½åœ¨æ‰§è¡Œ cli å‘½ä»¤æ—¶æå‰ç™»å½•ã€‚</p></blockquote><h2 id=ä½¿ç”¨-kcctl-æ·»åŠ -agent-èŠ‚ç‚¹åˆ°-kubeclipper>ä½¿ç”¨ kcctl æ·»åŠ  agent èŠ‚ç‚¹åˆ° KubeClipper</h2><blockquote><p>å½“å‰ kcctl join å‘½ä»¤ä»…æ”¯æŒæ·»åŠ  agent èŠ‚ç‚¹ï¼Œåç»­ä¼šé€æ­¥æ”¯æŒæ·»åŠ  server èŠ‚ç‚¹ã€‚
æ–°åŠ å…¥çš„ agent èŠ‚ç‚¹ä¹Ÿåº”è¯¥ç»Ÿä¸€è®¾ç½®å…å¯†ç™»å½•ï¼Œä¸”ç§é’¥ç›¸åŒã€‚</p></blockquote><p>Join agent èŠ‚ç‚¹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl join --agent<span style=color:#ce5c00;font-weight:700>=</span>AGENT_IPS
</span></span></code></pre></div><h2 id=ä½¿ç”¨-kcctl-ä»-kubeclipper-ä¸­åˆ é™¤-agent-èŠ‚ç‚¹>ä½¿ç”¨ kcctl ä» KubeClipper ä¸­åˆ é™¤ agent èŠ‚ç‚¹</h2><blockquote><p>å½“å‰ kcctl drain å‘½ä»¤ä»…æ”¯æŒåˆ é™¤ agent èŠ‚ç‚¹ï¼Œåç»­ä¼šé€æ­¥æ”¯æŒåˆ é™¤ server èŠ‚ç‚¹ã€‚</p></blockquote><p>Drain agent èŠ‚ç‚¹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl drain --agent<span style=color:#ce5c00;font-weight:700>=</span>AGENT_IPS
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å¼ºåˆ¶ drain èŠ‚ç‚¹ï¼Œå¿½ç•¥é”™è¯¯</span>
</span></span><span style=display:flex><span>kcctl drain --agent<span style=color:#ce5c00;font-weight:700>=</span>AGENT_IPS --force
</span></span></code></pre></div><p>å¦‚æœæ‚¨å‘ç°æ ¹æ®æœ¬æ–‡æ¡£æ— æ³•æˆåŠŸéƒ¨ç½² KubeClipperï¼Œè¯·ç§»æ­¥ <a href=https://github.com/kubeclipper/kubeclipper/issues>KubeClipper Github Issue</a>ï¼Œæå‡ºæ‚¨çš„æ„è§æˆ–åé¦ˆã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8dbd4e302cd86a4d0f71f71ce3b300de>4 - ä½¿ç”¨æ‰‹å†Œ</h1><div class=lead>ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ</div></div><div class=td-content><h1 id=pg-2cc05f33f011eb2f0671dd748cff9826>4.1 - åˆ›å»ºé›†ç¾¤</h1><div class=lead>KubeClipper æ”¯æŒé€šè¿‡å‘å¯¼å¼é¡µé¢åˆ›å»º kubernetes é›†ç¾¤ï¼Œå¹¶å®‰è£… CNIã€CSI ç­‰æ‰€éœ€æ’ä»¶ã€‚</div><h2 id=åˆ›å»ºé›†ç¾¤å‡†å¤‡å·¥ä½œ>åˆ›å»ºé›†ç¾¤å‡†å¤‡å·¥ä½œ</h2><ol><li>æ‚¨éœ€è¦å‡†å¤‡å……è¶³çš„å¯ç”¨èŠ‚ç‚¹ï¼Œå¦‚éœ€æ·»åŠ èŠ‚ç‚¹ï¼Œå‚è§â€œ<a href=/docs/tutorials/node-management/#%E6%B7%BB%E5%8A%A0%E8%8A%82%E7%82%B9>æ·»åŠ èŠ‚ç‚¹</a>â€æ•™ç¨‹ã€‚</li><li>å‡†å¤‡å¥½éœ€è¦éƒ¨ç½²çš„ kubernetesã€CRIã€calicoã€CSI å’Œå…¶ä»–æ’ä»¶çš„é•œåƒæˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œkubeclipper æä¾›äº†æ¨èçš„ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥æ ¹æ®å¹³å°æ‰€å¤„ç½‘ç»œç¯å¢ƒï¼Œé€‰æ‹©åœ¨çº¿ / ç¦»çº¿åï¼Œç›´æ¥åœ¨é¡µé¢ä¸Šé€‰å–ä½¿ç”¨ã€‚æ‚¨ä¹Ÿå¯ä»¥å°†éƒ¨ç½²æ‰€éœ€çš„é•œåƒä¸Šä¼ è‡³è‡ªå·±çš„é•œåƒä»“åº“ï¼Œå¹¶åœ¨éƒ¨ç½²æ—¶æŒ‡å®šã€‚æ›´å¤šå®‰è£…é…ç½®ï¼Œå‚è€ƒâ€œ<a href=#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE>é›†ç¾¤é…ç½®</a>â€ç« èŠ‚ã€‚</li></ol><h2 id=åˆ›å»ºå•èŠ‚ç‚¹å®éªŒé›†ç¾¤>åˆ›å»ºå•èŠ‚ç‚¹å®éªŒé›†ç¾¤</h2><ol><li><p>ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé›†ç¾¤â€ï¼Œè¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œåˆ›å»ºé›†ç¾¤â€æŒ‰é’®ã€‚</p></li><li><p>è¿›å…¥åˆ›å»ºé›†ç¾¤å‘å¯¼é¡µé¢çš„â€œèŠ‚ç‚¹é…ç½®â€é¡µé¢ã€‚å¡«å†™â€œé›†ç¾¤åç§°â€ï¼Œå¦‚ â€œtestâ€ï¼Œä¸éœ€é€‰æ‹©â€œé›†ç¾¤æ¨¡ç‰ˆâ€ã€‚é€‰æ‹©ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹ï¼Œæ·»åŠ ä¸ºæ§åˆ¶èŠ‚ç‚¹ï¼Œå¹¶åœ¨æ±¡ç‚¹ç®¡ç†åˆ—è¡¨ä¸­ï¼Œå°† master èŠ‚ç‚¹çš„æ±¡ç‚¹ç§»é™¤ã€‚ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ã€‚</p></li></ol><p><img src=/images/docs-tutorials/aio.png alt></p><ol start=3><li><p>è¿›å…¥åˆ›å»ºé›†ç¾¤å‘å¯¼é¡µé¢çš„â€œé›†ç¾¤é…ç½®â€é¡µé¢ã€‚é€‰æ‹©â€œç¦»çº¿å®‰è£…â€ï¼Œâ€œé•œåƒä»“åº“â€ä¸éœ€å¡«å†™ï¼Œå…¶ä»–é…ç½®éƒ½å¯ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œç‚¹å‡»â€œå¿«é€Ÿåˆ›å»ºâ€æŒ‰é’®ï¼Œè·³è½¬é…ç½®ç¡®è®¤é¡µé¢ï¼Œç‚¹å‡»â€œç¡®è®¤â€æŒ‰é’®ã€‚</p></li><li><p>å•èŠ‚ç‚¹çš„å®éªŒé›†ç¾¤åˆ›å»ºå®Œæˆï¼Œæ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µæŸ¥çœ‹é›†ç¾¤è¯¦æƒ…ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»â€œæŸ¥çœ‹æ—¥å¿—â€æŒ‰é’®ï¼ŒæŸ¥çœ‹é›†ç¾¤åˆ›å»ºè¿‡ç¨‹ä¸­çš„å®æ—¶æ—¥å¿—ã€‚</p></li></ol><h2 id=ä½¿ç”¨é•œåƒä»“åº“åˆ›å»ºé›†ç¾¤>ä½¿ç”¨é•œåƒä»“åº“åˆ›å»ºé›†ç¾¤</h2><p>å¦‚æœåˆ›å»ºçš„é›†ç¾¤ä¸­åŒ…å«è¾ƒå¤§çš„é•œåƒï¼Œæ¨èæ‚¨å°†æ‰€æœ‰é•œåƒä¸Šä¼ åˆ°ç‰¹å®šçš„é•œåƒä»“åº“ï¼Œåˆ›å»ºé›†ç¾¤ä¼šæ›´å¿«é€Ÿæ›´é¡ºç•…ã€‚</p><ol><li>æ·»åŠ é•œåƒä»“åº“ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé•œåƒä»“åº“â€ï¼Œè¿›å…¥é•œåƒä»“åº“åˆ—è¡¨é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œæ·»åŠ â€æŒ‰é’®ã€‚åœ¨æ·»åŠ é•œåƒä»“åº“çš„å¼¹çª—ä¸­è¾“å…¥é•œåƒä»“åº“åç§°å’Œå­˜æ”¾æœ‰é•œåƒçš„ä»“åº“åœ°å€ï¼Œç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ã€‚</li><li>åˆ›å»ºé›†ç¾¤ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé›†ç¾¤â€ï¼Œè¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œåˆ›å»ºé›†ç¾¤â€æŒ‰é’®ã€‚æŒ‰éœ€é…ç½®é›†ç¾¤èŠ‚ç‚¹ï¼Œåœ¨â€œé›†ç¾¤é…ç½®â€é¡µé¢çš„â€œé•œåƒä»“åº“â€ä¸­ï¼Œé€‰æ‹©ç¬¬ä¸€æ­¥æ·»åŠ çš„é•œåƒä»“åº“ï¼Œæ ¹æ®éœ€è¦å®Œæˆé›†ç¾¤å…¶ä»–é…ç½®ååˆ›å»ºé›†ç¾¤ã€‚</li></ol><h2 id=ä½¿ç”¨é›†ç¾¤æ¨¡ç‰ˆåˆ›å»ºé›†ç¾¤>ä½¿ç”¨é›†ç¾¤æ¨¡ç‰ˆåˆ›å»ºé›†ç¾¤</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨é›†ç¾¤æ¨¡ç‰ˆï¼Œç®€åŒ–é›†ç¾¤åˆ›å»ºæµç¨‹ã€‚</p><ol><li>æ·»åŠ æ¨¡ç‰ˆã€‚ä¿å­˜æ¨¡ç‰ˆæœ‰ä¸¤ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥åœ¨â€œé›†ç¾¤ç®¡ç†â€>â€œæ¨¡ç‰ˆç®¡ç†â€é¡µé¢ï¼Œæ·»åŠ é›†ç¾¤æ¨¡ç‰ˆï¼Œä»¥å¤‡åˆ›å»ºé›†ç¾¤æ—¶ä½¿ç”¨ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œä¿å­˜ä¸ºæ¨¡ç‰ˆâ€ï¼Œå°†å·²å­˜åœ¨çš„é›†ç¾¤é…ç½®ä¿å­˜ä¸ºæ¨¡ç‰ˆï¼Œä»¥ä¾¿åˆ›å»ºå‡ºå’Œè¯¥é›†ç¾¤åŒç­‰é…ç½®çš„ kubernetes é›†ç¾¤ã€‚</li><li>åˆ›å»ºé›†ç¾¤ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé›†ç¾¤â€ï¼Œè¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œåˆ›å»ºé›†ç¾¤â€æŒ‰é’®ï¼Œè¿›å…¥åˆ›å»ºé›†ç¾¤é¡µé¢ï¼Œå¡«å†™â€œé›†ç¾¤åç§°â€ï¼Œå¦‚ â€œdemoâ€ï¼Œé€‰æ‹©ç¬¬ä¸€æ­¥ä¸­ä¿å­˜çš„é›†ç¾¤æ¨¡ç‰ˆï¼Œæ·»åŠ æ‰€éœ€èŠ‚ç‚¹ï¼Œç‚¹å‡»å³ä¸‹è§’â€œå¿«é€Ÿåˆ›å»ºâ€æŒ‰é’®ï¼Œè·³è½¬è‡³â€œé…ç½®ç¡®è®¤â€é¡µé¢ï¼Œæ ¸å¯¹æ¨¡ç‰ˆä¿¡æ¯æ— è¯¯åï¼Œç‚¹å‡»â€œç¡®è®¤â€æŒ‰é’®ï¼Œåˆ›å»ºé›†ç¾¤ã€‚</li></ol><h2 id=é›†ç¾¤é…ç½®æŒ‡å—>é›†ç¾¤é…ç½®æŒ‡å—</h2><h3 id=èŠ‚ç‚¹é…ç½®>èŠ‚ç‚¹é…ç½®</h3><p>åœ¨èŠ‚ç‚¹é…ç½®é¡µé¢ï¼Œæ‚¨å¯ä»¥å¯¹èŠ‚ç‚¹è¿›è¡Œä»¥ä¸‹é…ç½®ï¼š</p><ul><li>åŒºåŸŸï¼šé›†ç¾¤æ‰€å±åŒºåŸŸï¼Œæ·»åŠ èŠ‚ç‚¹æ—¶å¯ä¸ºèŠ‚ç‚¹æŒ‡å®šç‰©ç†çš„æˆ–é€»è¾‘çš„åŒºåŸŸï¼Œä½¿ç”¨è¯¥åŒºåŸŸä¸‹èŠ‚ç‚¹åˆ›å»ºçš„ kubernetes é›†ç¾¤ä¹Ÿå±äºè¯¥åŒºåŸŸï¼Œä¸æ”¯æŒä½¿ç”¨è·¨åŒºåŸŸçš„å¤šä¸ªèŠ‚ç‚¹åˆ›å»ºé›†ç¾¤ã€‚</li><li>æ§åˆ¶èŠ‚ç‚¹ï¼šä¸ºé›†ç¾¤æŒ‡å®šå¥‡æ•°ä¸ªçš„æ§åˆ¶èŠ‚ç‚¹ï¼Œç”Ÿäº§ç¯å¢ƒä¸€èˆ¬ä½¿ç”¨3ä¸ªæ§åˆ¶èŠ‚ç‚¹ä»¥å®ç°é«˜å¯ç”¨ã€‚</li><li>å·¥ä½œèŠ‚ç‚¹ï¼šæ ¹æ®ä¸šåŠ¡è§„æ¨¡ï¼Œä¸ºæ–°é›†ç¾¤æ·»åŠ å·¥ä½œèŠ‚ç‚¹ã€‚</li><li>æ±¡ç‚¹ç®¡ç†ï¼šæ‚¨å¯ä»¥ä¸ºå·²æ·»åŠ çš„èŠ‚ç‚¹é…ç½®æ±¡ç‚¹ï¼Œkubeclipper ä¼šè‡ªåŠ¨ä¸ºæ§åˆ¶èŠ‚ç‚¹æ·»åŠ ä¸å…è®¸è°ƒåº¦ï¼ˆnoscheduleï¼‰çš„æ±¡ç‚¹ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œæ›´æ”¹ã€‚</li><li>èŠ‚ç‚¹æ ‡ç­¾ï¼šæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¸ºå·²æ·»åŠ çš„é›†ç¾¤èŠ‚ç‚¹é…ç½®æ ‡ç­¾ã€‚</li></ul><p>æ‚¨å¯ä»¥æŒ‰ä¸šåŠ¡éœ€è¦é…ç½®æ‰€éœ€èŠ‚ç‚¹ã€‚å¦‚æœéœ€è¦åˆ›å»ºéé«˜å¯ç”¨çš„å®éªŒé›†ç¾¤ï¼Œä¹Ÿå¯ä»¥ä»…æ·»åŠ ä¸€ä¸ªæ§åˆ¶èŠ‚ç‚¹ï¼Œå¹¶å°†æ§åˆ¶èŠ‚ç‚¹è‡ªåŠ¨æ·»åŠ çš„æ±¡ç‚¹ç§»é™¤ï¼Œè¯¦ç»†æ“ä½œå‚è§â€œ<a href=#%E5%88%9B%E5%BB%BA%E5%8D%95%E8%8A%82%E7%82%B9%E5%AE%9E%E9%AA%8C%E9%9B%86%E7%BE%A4>åˆ›å»ºå•èŠ‚ç‚¹å®éªŒé›†ç¾¤</a>â€ã€‚</p><h3 id=é›†ç¾¤é…ç½®>é›†ç¾¤é…ç½®</h3><p>åœ¨é›†ç¾¤é…ç½®é¡µé¢ï¼Œæ‚¨å¯ä»¥å¯¹é›†ç¾¤è¿›è¡Œä»¥ä¸‹é…ç½®ï¼š</p><ul><li>å®‰è£…æ–¹å¼å’Œé•œåƒä»“åº“ï¼š</li></ul><table><thead><tr><th></th><th>é•œåƒä»“åº“ä¸ºç©º</th><th>æŒ‡å®šé•œåƒä»“åº“</th></tr></thead><tbody><tr><td><strong>åœ¨çº¿ï¼ˆå…¬ç½‘ç¯å¢ƒï¼‰</strong></td><td>é…ç½®åŒ…æ¥æºï¼šä» kubeclipper.io ä¸‹è½½ã€‚<br>é•œåƒæ‹‰å–æ–¹å¼ï¼šé•œåƒé»˜è®¤ä»å®˜æ–¹é•œåƒä»“åº“æ‹‰å–ï¼Œå¦‚ kubernetes é•œåƒä» k8s.gcr.io æ‹‰å–ã€calico ä» docker.io æ‹‰å–ã€‚å¦‚æœæ‚¨è®¾ç½®äº†å›½å†…é•œåƒä»£ç†ï¼Œé•œåƒä¼šä»æ‚¨æŒ‡å®šçš„ â€œKC_IMAGE_REPO_MIRRORâ€ ä»£ç†ä»“åº“æ‹‰å–ã€‚</td><td>é…ç½®åŒ…æ¥æºï¼šä» kubeclipper.io ä¸‹è½½ã€‚<br>é•œåƒæ‹‰å–æ–¹å¼ï¼šä»å¡«å†™çš„é•œåƒä»“åº“æ‹‰å–ï¼Œç»„ä»¶å°†é»˜è®¤ç»§æ‰¿è¯¥ä»“åº“åœ°å€ï¼Œè¯·ç¡®ä¿è¯¥ä»“åº“å­˜åœ¨ç›¸å…³ç»„ä»¶é•œåƒï¼›ç»„ä»¶ä¹Ÿä¼šæä¾›ç‹¬ç«‹çš„é•œåƒä»“åº“å‚æ•°ï¼Œè®¾ç½®åç»„ä»¶é•œåƒä»è¯¥åœ°å€æ‹‰å–ã€‚</td></tr><tr><td><strong>ç¦»çº¿ï¼ˆå†…ç½‘ç¯å¢ƒï¼‰</strong></td><td>é…ç½®åŒ…æ¥æºï¼šä»æœ¬åœ° kubeclipper é›†ç¾¤ server èŠ‚ç‚¹ä¸‹è½½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ kcctl resource list å‘½ä»¤æŸ¥çœ‹æœ¬åœ°å¯ç”¨é…ç½®åŒ…ï¼Œæˆ–ä½¿ç”¨ kcctl resource push å‘½ä»¤ä¸Šä¼ æ‰€éœ€é…ç½®åŒ…ã€‚<br>é•œåƒæ‹‰å–æ–¹å¼ï¼šä»æœ¬åœ° kubeclipper é›†ç¾¤ server èŠ‚ç‚¹ä¸‹è½½ï¼Œä¸‹è½½åç”± CRI è¿›è¡Œé•œåƒå¯¼å…¥ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ kcctl resource list å‘½ä»¤æŸ¥çœ‹æœ¬åœ°å¯ç”¨é•œåƒåŒ…ï¼Œæˆ–ä½¿ç”¨ kcctl resource push å‘½ä»¤ä¸Šä¼ æ‰€éœ€é•œåƒåŒ…ã€‚</td><td>é…ç½®åŒ…æ¥æºï¼šä»æœ¬åœ°ä¸‹è½½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ kcctl resource list å‘½ä»¤æŸ¥çœ‹æœ¬åœ°å¯ç”¨é…ç½®åŒ…ï¼Œæˆ–ä½¿ç”¨ kcctl resource push å‘½ä»¤ä¸Šä¼ æ‰€éœ€é…ç½®åŒ…ã€‚<br>é•œåƒæ‹‰å–æ–¹å¼ï¼šä»å¡«å†™çš„é•œåƒä»“åº“æ‹‰å–ï¼Œç»„ä»¶å°†é»˜è®¤ç»§æ‰¿è¯¥ä»“åº“åœ°å€ï¼Œè¯·ç¡®ä¿è¯¥ä»“åº“å­˜åœ¨ç›¸å…³ç»„ä»¶é•œåƒï¼›ç»„ä»¶ä¹Ÿä¼šæä¾›ç‹¬ç«‹çš„é•œåƒä»“åº“å‚æ•°ï¼Œè®¾ç½®åç»„ä»¶é•œåƒä»è¯¥åœ°å€æ‹‰å–ã€‚kubeclipper æä¾› Docker Registry æ–¹æ¡ˆï¼Œå¹¶ä½¿ç”¨ kcctl registry å‘½ä»¤è¡Œè¿›è¡Œç®¡ç†ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–è‡ªæœ‰é•œåƒä»“åº“ã€‚</td></tr></tbody></table><ul><li><p>kubernetes ç‰ˆæœ¬ï¼šæŒ‡å®šé›†ç¾¤ kubernetes ç‰ˆæœ¬ã€‚å½“æ‚¨é€‰æ‹©ç¦»çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä»å½“å‰ç¯å¢ƒä¸­é…ç½®åŒ…çš„ kubernetes ç‰ˆæœ¬ä¸­é€‰æ‹©ï¼›å½“æ‚¨é€‰æ‹©åœ¨çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä» kubeclipper å®˜æ–¹æ¨èçš„ç‰ˆæœ¬ä¸­é€‰æ‹©ã€‚</p></li><li><p>ETCD æ•°æ®ç›®å½•ï¼šå¯æŒ‡å®š ETCD æ•°æ®ç›®å½•ï¼Œé»˜è®¤ä¸º/var/lib/etcdã€‚</p></li><li><p>kubelet æ•°æ®ç›®å½•ï¼šå¯æŒ‡å®š kubelet æ•°æ®ç›®å½•ï¼Œé»˜è®¤ä¸º /var/lib/kubeletã€‚</p></li><li><p>CertSANsï¼škubernetes é›†ç¾¤ ca è¯ä¹¦ç­¾åçš„ ip æˆ–è€…åŸŸåï¼Œå¯å¡«å†™å¤šä¸ªã€‚</p></li><li><p>å®¹å™¨è¿è¡Œæ—¶ï¼šæ ¹æ®æŒ‡å®š kubernetes ç‰ˆæœ¬ï¼Œkubernetes ç‰ˆæœ¬åœ¨ v1.20.0 ä¹‹å‰ï¼Œå®¹å™¨è¿è¡Œæ—¶é»˜è®¤ dockerï¼Œä¹‹åé»˜è®¤ containerdï¼›v1.24.0 ä¹‹åä¸æ”¯æŒ dockerã€‚</p></li><li><p>å®¹å™¨è¿è¡Œæ—¶ç‰ˆæœ¬ï¼šæŒ‡å®š containerd / docker ç‰ˆæœ¬ã€‚ä¸ kubernetes ç›¸åŒï¼Œå½“æ‚¨é€‰æ‹©ç¦»çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä»å½“å‰ç¯å¢ƒä¸­é…ç½®åŒ…çš„ç‰ˆæœ¬ä¸­é€‰æ‹©ï¼›å½“æ‚¨é€‰æ‹©åœ¨çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä» kubeclipper å®˜æ–¹æ¨èçš„ç‰ˆæœ¬ä¸­é€‰æ‹©ã€‚</p></li><li><p>Containerd æ•°æ®ç›®å½•ï¼šå¯å¡«å†™ config.toml é…ç½®ä¸­çš„ root dirï¼Œé»˜è®¤ä¸º/var/lib/containerdã€‚</p></li><li><p>Docker æ•°æ®ç›®å½•ï¼šå¯å¡«å†™ daemon.json é…ç½®ä¸­çš„ root dirï¼Œé»˜è®¤ä¸º/var/lib/dockerã€‚</p></li><li><p>Containerd é•œåƒä»“åº“ï¼šå­˜æ”¾ containerd é•œåƒçš„ä»“åº“åœ°å€ï¼Œconfig.toml é…ç½®ä¸­çš„ registry.mirrorsï¼Œå¯å¡«å†™å¤šä¸ªã€‚</p></li><li><p>Docker é•œåƒä»“åº“ï¼šå­˜æ”¾ docker é•œåƒçš„ä»“åº“åœ°å€ï¼Œdaemon.json é…ç½®ä¸­çš„ insecure registry,å¯å¡«å†™å¤šä¸ªã€‚</p></li><li><p>DNS åŸŸåï¼škubernetes é›†ç¾¤çš„åŸŸåï¼Œé»˜è®¤ä¸º cluster.localã€‚</p></li><li><p>Worker è´Ÿè½½ IPï¼šç”¨äº worker èŠ‚ç‚¹åˆ°å¤š master çš„è´Ÿè½½å‡è¡¡ï¼Œå•ä¸€ master ä¸éœ€è¦è®¾ç½®ã€‚</p></li><li><p>å¤–éƒ¨è®¿é—® IPï¼šå¯ä»¥å¡«å†™ä¸€ä¸ªæµ®åŠ¨ IP ç»™ç”¨æˆ·è®¿é—®ï¼Œå¯ä¸ºç©ºã€‚</p></li><li><p>å¤‡ä»½ç©ºé—´ï¼šé›†ç¾¤å¤‡ä»½æ–‡ä»¶å­˜å‚¨ä½ç½®ã€‚</p></li></ul><h3 id=cni-é…ç½®>CNI é…ç½®</h3><p>å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒ Calico ä½œä¸ºé›†ç¾¤ CNIã€‚</p><p>Calico å°†ç”¨æˆ·è®¾ç½®çš„ pod cidr åˆ†ä¸ºè‹¥å¹²ä¸ª block (ç½‘æ®µ)ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ¨æ€çš„åˆ†é…ç»™éœ€è¦çš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨èŠ‚ç‚¹ä¸­é€šè¿‡ bgp peer ç»´æŠ¤é›†ç¾¤èŠ‚ç‚¹çš„è·¯ç”±è¡¨ã€‚</p><p>ä¾‹å¦‚ï¼šå®¹å™¨çš„åœ°å€æ± ï¼š172.25.0.0/16ï¼ŒåŠ¨æ€åˆ†é…çš„ç½‘æ®µæ± : 172.25.0.0 - 172.25.255.192 (172.25.0.0/26 å³ 10 ä¸ªæ¯”ç‰¹ä½)ï¼ŒåŠ¨æ€åˆ†é…çš„ç½‘æ®µæ•°: 1023ï¼Œæ¯ä¸ªç½‘æ®µçš„ pod æ•°é‡ä¸º: 61 (193-254)ï¼Œæ€» pod æ•°é‡ä¸º1023 * 61 = 62403ï¼Œç›¸å¯¹æœ€å¤§èŠ‚ç‚¹æ•°(æŒ‰ç…§200ä¸šåŠ¡ pod ä¸ºåŸºå‡†å€¼)ï¼š312ã€‚</p><p>ç›®å‰ä¸å»ºè®®å¤§äº50ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œå¤§äº50ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤å»ºè®®æ‰‹åŠ¨é…ç½® route reflectionï¼Œç”¨æ¥ä¼˜åŒ–é›†ç¾¤ä¸­çš„èŠ‚ç‚¹çš„è·¯ç”±è¡¨ç»´æŠ¤çš„ç¨³å®šæ€§ã€‚</p><p>ä½¿ç”¨ Calico ä½œä¸ºé›†ç¾¤ CNIï¼Œæ‚¨éœ€è¦è¿›è¡Œä»¥ä¸‹é…ç½®ï¼š</p><ul><li><p>Calico æ¨¡å¼ï¼šæ”¯æŒ5ç§ç½‘ç»œæ¨¡å¼ï¼š</p><ul><li>Overlay-IPIP-All: ä½¿ç”¨ IP-in-IP æŠ€æœ¯æ‰“é€šä¸åŒèŠ‚ç‚¹çš„ pod çš„ç½‘ç»œ,é€šå¸¸è¿™æ ·çš„æ–¹å¼ä½¿ç”¨åœ¨åº•å±‚å¹³å°æ˜¯ iaas çš„ç¯å¢ƒä¹‹ä¸­,å½“ç„¶å¦‚æœä½ åº•å±‚ç½‘è·¯ç¯å¢ƒç›´æ¥æ˜¯ç‰©ç†è®¾å¤‡çš„ä¹Ÿå®Œå…¨å¯ä»¥ä½¿ç”¨åªä¸è¿‡æ•ˆç‡å’Œçµæ´»åº¦éƒ½ä¼šå¤§æ‰“æŠ˜æ‰£,éœ€è¦æ³¨æ„çš„æ˜¯ä½ éœ€è¦ç¡®è®¤åº•å±‚ç½‘ç»œç¯å¢ƒ(underlay)æ˜¯æ”¯æŒ IPIP åè®®çš„.(ä½¿ç”¨ overlay çš„ç½‘ç»œæ–¹å¼å¯¹ç½‘ç»œæ€§èƒ½é€ æˆä¸€å®šçš„å½±å“)ã€‚</li><li>Overlay-Vxlan-All: ä½¿ç”¨ IP-in-IP æŠ€æœ¯æ‰“é€šä¸åŒèŠ‚ç‚¹çš„ pod çš„ç½‘ç»œ,é€šå¸¸è¿™æ ·çš„æ–¹å¼ä½¿ç”¨åœ¨åº•å±‚å¹³å°æ˜¯ iaas çš„ç¯å¢ƒä¹‹ä¸­,å½“ç„¶å¦‚æœä½ åº•å±‚ç½‘è·¯ç¯å¢ƒç›´æ¥æ˜¯ç‰©ç†è®¾å¤‡çš„ä¹Ÿå®Œå…¨å¯ä»¥ä½¿ç”¨åªä¸è¿‡æ•ˆç‡å’Œçµæ´»åº¦éƒ½ä¼šå¤§æ‰“æŠ˜æ‰£,ä»–ç†è®ºä¸Šå¯ä»¥åœ¨ä»»ä½•çš„ç½‘ç»œç¯å¢ƒä¸Šè¿è¡Œ,é€šå¸¸åœ¨åº•å±‚ç¯å¢ƒä¸æ”¯æŒ IPIP åè®®çš„æ—¶å€™æˆ‘ä»¬ä¼šä½¿ç”¨ä»–.(ä½¿ç”¨ overlay çš„ç½‘ç»œæ–¹å¼å¯¹ç½‘ç»œæ€§èƒ½é€ æˆä¸€å®šçš„å½±å“)ã€‚</li><li>BGP: ä½¿ç”¨ IP-in-IP æŠ€æœ¯æ‰“é€šä¸åŒèŠ‚ç‚¹çš„ pod çš„ç½‘ç»œ,é€šå¸¸è¿™æ ·çš„æ–¹å¼ä½¿ç”¨åœ¨è£¸æœºçš„ç¯å¢ƒä¸Š,å½“ç„¶åº• Iaas å¹³å°æ”¯æŒ BGP çš„è¯ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„,è¿™ç§æ¨¡å¼ä¸‹ pod çš„ ip é€šä¿¡æ˜¯é€šè¿‡ é›†ç¾¤ä¸­çš„å„ä¸ªèŠ‚ç‚¹ä¸­äº’ç›¸äº¤æ¢è·¯ç”±è¡¨æ¥å®Œæˆ pod ä¹‹é—´çš„é€šä¿¡çš„,å¦‚æœä½ éœ€è¦æ‰‹åŠ¨æ‰“é€šå¤šä¸ªé›†ç¾¤ä¹‹é—´çš„ pod ç½‘ç»œéœ€è¦æ³¨æ„ä½ åˆ†é…çš„åœ°å€æ–­ä¸åº”è¯¥æœ‰å†²çªã€‚</li><li>Overaly-IPIP-Cross-Subnet: ä½¿ç”¨ IP-in-IP æŠ€æœ¯æ‰“é€šä¸åŒèŠ‚ç‚¹çš„ pod çš„ç½‘ç»œ,é€šå¸¸è¿™æ ·çš„æ–¹å¼ä½¿ç”¨åœ¨åº•å±‚å¹³å°æ˜¯ iaas çš„ç¯å¢ƒä¹‹ä¸­,éœ€è¦æ³¨æ„çš„æ˜¯ä½ éœ€è¦ç¡®è®¤åº•å±‚ç½‘ç»œç¯å¢ƒ(underlay)æ˜¯æ”¯æŒ IPIP åè®®çš„.å’Œ Overlay-IPIP-All çš„ä¸åŒä¹‹å¤„åœ¨äº,å¦‚æœ 2 ä¸ªä¸åŒèŠ‚ç‚¹ä½†åœ¨åŒä¸€ä¸ªç½‘æ®µä¸­çš„ä¸Š pod äº’ç›¸é€šä¿¡æ—¶æ˜¯é€šè¿‡è·¯ç”±è¡¨,è¿™æ ·å¯ä»¥æé«˜åœ¨ä¸åŒèŠ‚ç‚¹ä½†åœ¨åŒä¸€ä¸ªç½‘æ®µä¸­çš„ä¸Š pod äº’ç›¸é€šä¿¡æ—¶çš„æ•ˆç‡ã€‚</li><li>Overaly-Vxlan-Cross-Subnet: å’Œ Overaly-IPIP-Cross-Subnet é€»è¾‘ç›¸ä¼¼ä¸å†åšé‡å¤çš„è§£é‡Šã€‚</li></ul></li><li><p>Calico ç‰ˆæœ¬ï¼šæŒ‡å®š calico ç‰ˆæœ¬ã€‚ä¸ kubernetes ç›¸åŒï¼Œå½“æ‚¨é€‰æ‹©ç¦»çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä»å½“å‰ç¯å¢ƒä¸­é…ç½®åŒ…çš„ç‰ˆæœ¬ä¸­é€‰æ‹©ï¼›å½“æ‚¨é€‰æ‹©åœ¨çº¿å®‰è£…çš„æ—¶å€™ï¼Œå¯ä»¥ä» kubeclipper å®˜æ–¹æ¨èçš„ç‰ˆæœ¬ä¸­é€‰æ‹©ã€‚</p></li><li><p>IPç‰ˆæœ¬ï¼šå¯æŒ‡å®š IP ç‰ˆæœ¬ä¸º IPV4 æˆ– IPV4 IPV6 åŒæ ˆã€‚</p></li><li><p>æœåŠ¡å­ç½‘ï¼šå¡«å†™ service å­ç½‘ CIDRï¼Œv4 é»˜è®¤ä¸ºï¼š10.96.0.0/16ï¼Œv6 é»˜è®¤ä¸º fd03::/112ï¼Œæ³¨æ„ Service ç½‘ç»œä¸å¾—ä¸ä»»ä½•ä¸»æœºç½‘ç»œé‡å ã€‚</p></li><li><p>Pod CIDRï¼šå¡«å†™ Pod å­ç½‘ CIDRï¼Œv4 é»˜è®¤ï¼š172.25.0.0/24ï¼Œv6 é»˜è®¤ä¸º fd05::/120ï¼Œæ³¨æ„ Pod ç½‘ç»œä¸å¾—ä¸ä»»ä½•ä¸»æœºç½‘ç»œé‡å ã€‚</p></li><li><p>podç½‘è·¯çš„åº•å±‚ï¼š</p><ul><li>first-foundï¼ˆé»˜è®¤ï¼‰ï¼šç¨‹åºä¼šæ ¹æ® ipfamily (v4 æˆ– v6)éå†æ‰€æœ‰çš„æœ‰æ•ˆçš„ ip åœ°å€ï¼ˆlocal,loop backï¼Œdocker bridgeç­‰ä¼šè¢«è‡ªåŠ¨æ’é™¤ï¼‰é€šå¸¸å¦‚æœæ˜¯å¤šç½‘å¡æ—¶ä¼šæ’é™¤é»˜è®¤ç½‘å…³ä»¥å¤–çš„ç½‘å¡çš„ ip ä½œä¸ºèŠ‚ç‚¹ä¹‹é—´çš„è·¯ç”±åœ°å€ã€‚</li><li>can-reachï¼šé€šè¿‡æ£€æŸ¥åŸŸåæˆ–è€… ip çš„å¯è¾¾æ€§æ¥è®¾ç½®èŠ‚ç‚¹ä¹‹é—´çš„è·¯ç”±åœ°å€ã€‚</li><li>interfaceï¼šæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è·å–æ‰€æœ‰æ»¡è¶³çš„ç½‘å¡è®¾å¤‡åç§°å¹¶è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³è¡¨è¾¾å¼ç½‘å¡çš„åœ°å€ä½œä¸ºèŠ‚ç‚¹ä¹‹é—´çš„è·¯ç”±åœ°å€ã€‚</li></ul></li><li><p>MTUï¼šä¸º Calico ç¯å¢ƒé…ç½®æœ€å¤§ä¼ è¾“å•å…ƒ(MTU)ï¼Œå»ºè®®ä¸å¤§äº1440ï¼Œé»˜è®¤ä¸º1440ï¼Œè¯¦æƒ…è§ <a href=https://docs.projectcalico.org/networking/mtu>https://docs.projectcalico.org/networking/mtu</a>ã€‚</p></li></ul><h3 id=å­˜å‚¨é…ç½®>å­˜å‚¨é…ç½®</h3><p>Kubeclipperå½“å‰ç‰ˆæœ¬å†…ç½®äº† NFS ä½œä¸ºé›†ç¾¤å¤–æ¥å­˜å‚¨ã€‚</p><p>å¯¹æ¥ NFS ç±»å‹çš„å¤–æ¥å­˜å‚¨ï¼Œæ‚¨éœ€è¦è®¾ç½®ä»¥ä¸‹å†…å®¹ï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>ä½œç”¨è¯´æ˜</th><th>å¡«å†™è¯´æ˜/å¯é€‰é¡¹</th></tr></thead><tbody><tr><td><strong>æœåŠ¡åœ°å€</strong></td><td>ServerAddrï¼ŒNFSçš„æœåŠ¡åœ°å€</td><td>å¿…å¡«</td></tr><tr><td><strong>å…±äº«è·¯å¾„</strong></td><td>SharedPathï¼ŒNFSçš„æœåŠ¡æŒ‚è½½è·¯å¾„</td><td>å¿…å¡«</td></tr><tr><td><strong>å­˜å‚¨ç±»</strong></td><td>StorageClassNameï¼Œå­˜å‚¨ç±»çš„åç§°</td><td>é»˜è®¤ä¸º nfs-scï¼Œå¯è‡ªå®šä¹‰åç§°ï¼Œä¸å¯ä¸é›†ç¾¤å…¶ä»–å­˜å‚¨ç±»é‡å¤</td></tr><tr><td><strong>å›æ”¶ç­–ç•¥</strong></td><td>ReclaimPolicyï¼ŒVPCå›æ”¶ç­–ç•¥</td><td>åˆ é™¤ Delete / ä¿ç•™ Retain</td></tr><tr><td><strong>æŒ‚è½½é€‰é¡¹</strong></td><td>MountOptionsï¼ŒNFS çš„ options å‚æ•°ï¼Œå¦‚nfsvers=3</td><td>é€‰å¡«ï¼Œå¯å¡«å†™å¤šä¸ª</td></tr><tr><td><strong>å‰¯æœ¬æ•°</strong></td><td>Replicasï¼ŒNFS provisionerå‰¯æœ¬æ•°</td><td>é»˜è®¤ä¸º1</td></tr></tbody></table><p>è®¾ç½®å®Œå¤–æ¥å­˜å‚¨åï¼Œä¸‹æ–¹å¡ç‰‡ä¼šæ˜¾ç¤ºæ‚¨å·²ç»å¼€å¯çš„å­˜å‚¨ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸€ä¸ªå­˜å‚¨ç±»ä½œä¸ºé»˜è®¤å­˜å‚¨ï¼Œå¯¹äºæœªæŒ‡å®šç‰¹å®šStorageClass çš„ PVC ï¼Œä¼šç›´æ¥ä½¿ç”¨é»˜è®¤çš„å­˜å‚¨ç±»ã€‚</p><h3 id=é…ç½®ç¡®è®¤>é…ç½®ç¡®è®¤</h3><p>æ‚¨å¯ä»¥åœ¨é…ç½®ç¡®è®¤é¡µé¢æµè§ˆé›†ç¾¤çš„é…ç½®ä¿¡æ¯ï¼Œç¡®è®¤æ— è¯¯åï¼Œç‚¹å‡»â€œç¡®è®¤â€œæŒ‰é’®ã€‚ä¹Ÿå¯ä»¥ç‚¹å‡»å¡ç‰‡å³ä¾§çš„â€œç¼–è¾‘â€æŒ‰é’®ï¼Œè·³å›åˆ°ç›¸åº”æ­¥éª¤ä¿®æ”¹é›†ç¾¤ä¿¡æ¯ã€‚</p><p>å®‰è£…é›†ç¾¤å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œæ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µé¢æŸ¥çœ‹æ“ä½œæ—¥å¿—ï¼Œè·Ÿè¸ªé›†ç¾¤å®‰è£…çŠ¶æ€ã€‚</p><h3 id=è®¾ç½®å›½å†…é•œåƒä»£ç†å¯é€‰>è®¾ç½®å›½å†…é•œåƒä»£ç†ï¼ˆå¯é€‰ï¼‰</h3><blockquote><p>Q: è®¾ç½®å›½å†…é•œåƒä»£ç†æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p>A: è®¾ç½®äº†å›½å†…é•œåƒä»£ç†ï¼Œä½¿ç”¨åœ¨çº¿å®‰è£…åŠŸèƒ½æ—¶ï¼Œä¼šä»æŒ‡å®šä»£ç†æ‹‰å– kubernetes ç›¸å…³é•œåƒï¼Œé¿å…åœ¨å›½å†…æ— æ³•è®¿é—® gcr è€Œå¯¼è‡´é›†ç¾¤å®‰è£…å¤±è´¥é—®é¢˜ã€‚</p></blockquote><p>ä»¥ä¸‹è®¾ç½®æ–¹æ³•éœ€åœ¨æ‰§è¡Œ <code>kcctl deploy</code> éƒ¨ç½²å‘½ä»¤çš„æœºå™¨ä¸Šå®Œæˆï¼Œä»»é€‰å…¶ä¸€å³å¯ã€‚</p><p>**æ–¹å¼ä¸€ï¼š**è®¾ç½® KC_IMAGE_REPO_MIRROR ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ¨èä½¿ç”¨é˜¿é‡Œäº‘é•œåƒä»£ç†ï¼Œæ‚¨ä¹Ÿå¯ä»¥è‡ªè¡Œè®¾å®š</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>KC_IMAGE_REPO_MIRROR</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;registry.aliyuncs.com/google_containers&#34;</span>
</span></span></code></pre></div><p>**æ–¹å¼äºŒï¼š**è®¾ç½® /etc/kc/kc.env ç¯å¢ƒå˜é‡æ–‡ä»¶</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># åˆ›å»º kc ç›®å½•</span>
</span></span><span style=display:flex><span>mkdir -pv /etc/kc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># åˆ›å»º kc.env æ–‡ä»¶å¹¶ä¼ å…¥ç¯å¢ƒå˜é‡ä¿¡æ¯</span>
</span></span><span style=display:flex><span>cat <span style=color:#4e9a06>&lt;&lt;EOF &gt; /etc/kc/kc.env
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>KC_IMAGE_REPO_MIRROR=&#34;registry.aliyuncs.com/google_containers&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>EOF</span>
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-d02d74740bfa769ed1533f083ba56ac2>4.2 - é›†ç¾¤æ‰˜ç®¡</h1><div class=lead>å¯¹äºåœ¨ kubeclipper å¹³å°å¤–è¿è¡Œçš„ kubernetes é›†ç¾¤ï¼Œæ‚¨å¯ä»¥æ‰˜ç®¡è‡³ kubeclipper å¹³å°å†…è¿›è¡Œç®¡ç†ï¼Œå½“å‰ç‰ˆæœ¬æ”¯æŒæ‰˜ç®¡ kubeadmin é›†ç¾¤ã€‚</div><h2 id=kubeadm-é›†ç¾¤æ‰˜ç®¡>Kubeadm é›†ç¾¤æ‰˜ç®¡</h2><p>æ‰˜ç®¡ç”± kubeadm åˆ›å»ºå’Œç®¡ç†çš„ kubernetes é›†ç¾¤ï¼Œkubeclipper ä¼šé€šè¿‡ kubeconfig æ–‡ä»¶ï¼Œè·å–é›†ç¾¤å’ŒèŠ‚ç‚¹ä¿¡æ¯ï¼Œå¹¶å¯¼å…¥åˆ° kubeclipper å¹³å°ä¸­ã€‚</p><p>ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé›†ç¾¤æ‰˜ç®¡â€æŒ‰é’®è¿›å…¥é›†ç¾¤æ‰˜ç®¡é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œæ·»åŠ â€æŒ‰é’®ï¼Œåœ¨æ·»åŠ æä¾›å•†å¼¹çª—ä¸­ï¼Œå¡«å†™æä¾›å•†åç§°ï¼ˆå¦‚ kubeadm-demoï¼‰å’Œæè¿°åï¼Œå¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li>åŒºåŸŸï¼šæä¾›å•†ä¸‹çš„é›†ç¾¤å’ŒèŠ‚ç‚¹åœ¨ kubeclipper å¹³å°ä¸­çš„æ‰€å±åŒºåŸŸã€‚</li><li>æä¾›å•†ç±»å‹ï¼šé€‰æ‹© kubeadmã€‚</li><li>èŠ‚ç‚¹è¿æ¥æ–¹å¼ï¼šé›†ç¾¤èŠ‚ç‚¹çš„è¿æ¥æ–¹å¼ï¼Œå¯ä»¥é€‰æ‹©â€œç§é’¥â€æˆ–è€…â€œå¯†ç â€ï¼Œæ‚¨éœ€è¦ç¡®ä¿å¯ä»¥é€šè¿‡æ‰€é€‰æ–¹å¼ ssh åˆ°é›†ç¾¤èŠ‚ç‚¹ã€‚<ul><li>é€‰æ‹©â€œç§é’¥â€ï¼Œéœ€è¦è¾“å…¥èŠ‚ç‚¹ç”¨æˆ·åå’Œç§é’¥ä¿¡æ¯ã€‚</li><li>é€‰æ‹©â€œå¯†ç â€ï¼Œéœ€è¦è¾“å…¥èŠ‚ç‚¹ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ã€‚</li></ul></li><li>é›†ç¾¤åç§°ï¼šä½œä¸ºåœ¨æœ¬å¹³å°çš„å±•ç¤ºåç§°ï¼Œä¸èƒ½ä¸å…¶ä»–é›†ç¾¤é‡å¤ã€‚</li><li>KubeConfigï¼šæ‰˜ç®¡é›†ç¾¤çš„ KubeConfig æ–‡ä»¶ã€‚</li></ul><p>å¡«å†™å®Œæˆåç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œå°†é›†ç¾¤å’ŒèŠ‚ç‚¹å¯¼å…¥åˆ°å¹³å°ä¸­ã€‚ç‚¹å‡»æä¾›å•†åç§°ï¼ˆkubeadm-demoï¼‰ï¼Œè¿›å…¥æä¾›å•†è¯¦æƒ…é¡µï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æä¾›å•†ä¸‹çš„é›†ç¾¤ï¼Œå¹¶å¯¹æä¾›å•†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>åŒæ­¥ï¼šç³»ç»Ÿå°†æ¯éš”4å°æ—¶å®šæœŸåŒæ­¥é›†ç¾¤ä¿¡æ¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥ç‚¹å‡»â€œåŒæ­¥â€æŒ‰é’®æ‰‹åŠ¨æ‰§è¡Œã€‚</li><li>ç¼–è¾‘ï¼šç¼–è¾‘æä¾›å•†çš„åç§°ã€æè¿°ã€è®¿é—®ä¿¡æ¯ã€èŠ‚ç‚¹è¿æ¥æ–¹å¼ã€‚</li><li>ç§»é™¤ï¼šç§»é™¤é›†ç¾¤ä¿¡æ¯ï¼Œä½†é›†ç¾¤ä¸ä¼šè¢«å¸è½½ã€‚</li></ul><h2 id=æ‰˜ç®¡é›†ç¾¤ç®¡ç†>æ‰˜ç®¡é›†ç¾¤ç®¡ç†</h2><p>æ‚¨å¯ä»¥ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œé›†ç¾¤â€è¿›å…¥é›†ç¾¤åˆ—è¡¨é¡µé¢ï¼ŒæŸ¥çœ‹åŒ…æ‹¬æ‰˜ç®¡é›†ç¾¤å’Œæœ¬åœ°é›†ç¾¤åœ¨å†…çš„æ‰€æœ‰é›†ç¾¤åˆ—è¡¨ï¼Œå¯¹äºä¸åŒé›†ç¾¤ï¼Œæ”¯æŒçš„ç®¡ç†æ“ä½œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p>æ³¨æ„ï¼šæ‰˜ç®¡çš„ kubeadm é›†ç¾¤å®‰è£…æ’ä»¶æˆ–å¤–æ¥å­˜å‚¨çš„é•œåƒæ¥æºä¼šé»˜è®¤ä½¿ç”¨ docker.ioï¼Œå¦‚æœæ‚¨å¤„äºç¦»çº¿ç¯å¢ƒï¼Œéœ€è¦åœ¨å®‰è£…æ’ä»¶æ—¶å¡«å†™å¯è®¿é—®çš„ç¦»çº¿é•œåƒä»“åº“åœ°å€ï¼Œè¯¥ç¦»çº¿é•œåƒä»“åº“çš„åœ°å€éœ€è¦é¢„å…ˆæ·»åŠ åˆ° cri çš„ç§æœ‰é•œåƒä»“åº“é…ç½®ï¼Œå‚è§ <a href=/docs/tutorials/cluster-management/#cri-%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE>CRI é•œåƒä»“åº“é…ç½®</a> ã€‚</p><table><thead><tr><th><strong>åŠŸèƒ½</strong></th><th><strong>Kubeclipper åˆ›å»ºçš„é›†ç¾¤</strong></th><th><strong>æ‰˜ç®¡çš„ kubeadm é›†ç¾¤</strong></th></tr></thead><tbody><tr><td>æŸ¥çœ‹æ—¥å¿—</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>ä»»åŠ¡å¤±è´¥åé‡è¯•</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>è®¿é—® kubectl</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>ç¼–è¾‘</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>ä¿å­˜ä¸ºæ¨¡ç‰ˆ</td><td>âœ”ï¸</td><td>âœ˜</td></tr><tr><td>CRI é•œåƒä»“åº“é…ç½®</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>æ·»åŠ /ç§»é™¤é›†ç¾¤èŠ‚ç‚¹</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>å¤‡ä»½å’Œæ¢å¤ç®¡ç†</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>ç‰ˆæœ¬å‡çº§</td><td>âœ”ï¸</td><td>âœ˜</td></tr><tr><td>åˆ é™¤é›†ç¾¤</td><td>âœ”ï¸</td><td>âœ˜</td></tr><tr><td>ç§»é™¤é›†ç¾¤ï¼ˆæä¾›å•†ï¼‰</td><td>/</td><td>âœ”ï¸</td></tr><tr><td>é‡ç½®çŠ¶æ€</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>é›†ç¾¤æ’ä»¶ç®¡ç†</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>æ›´æ–°é›†ç¾¤è¯ä¹¦</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr><tr><td>æŸ¥çœ‹ kubeconfig</td><td>âœ”ï¸</td><td>âœ”ï¸</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-a8bf4ad6bad192cf81433dc9082057f8>4.3 - é›†ç¾¤ç®¡ç†</h1><div class=lead>kubeclipper æ”¯æŒå¯¹ kubernetes é›†ç¾¤çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</div><h2 id=é›†ç¾¤æ“ä½œæ—¥å¿—æŸ¥çœ‹>é›†ç¾¤æ“ä½œæ—¥å¿—æŸ¥çœ‹</h2><p>åœ¨é›†ç¾¤è¯¦æƒ…é¡µé¢ï¼Œç‚¹å‡»â€œæ“ä½œæ—¥å¿—â€æ ‡ç­¾é¡µï¼Œå¯ä»¥æŸ¥çœ‹é›†ç¾¤æ“ä½œæ—¥å¿—åˆ—è¡¨ã€‚ç‚¹å‡»æ“ä½œæ—¥å¿—å³ä¾§â€œæŸ¥çœ‹æ—¥å¿—â€æŒ‰é’®ï¼Œå¯ä»¥åœ¨å¼¹çª—ä¸­æŸ¥çœ‹å…¨éƒ¨æ­¥éª¤å’ŒèŠ‚ç‚¹çš„è¯¦ç»†æ—¥å¿—ã€‚ç‚¹å‡»å·¦ä¾§æ­¥éª¤åç§°ï¼Œå¯æŸ¥çœ‹æ‰§è¡Œæ­¥éª¤è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºã€‚</p><p>åœ¨é›†ç¾¤æ“ä½œæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç‚¹å‡»æŸ¥çœ‹æ—¥å¿—ï¼Œæ‚¨å¯ä»¥å®æ—¶æŸ¥çœ‹åˆ°æ—¥å¿—æ›´æ–°æ¥è·Ÿè¸ªæ“ä½œæ‰§è¡Œæƒ…å†µã€‚å¯¹äºæ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—ï¼Œæ‰¾åˆ°çº¢è‰²åœ†ç‚¹æ ‡æ³¨çš„æ‰§è¡Œæ­¥éª¤å’ŒèŠ‚ç‚¹ï¼Œå¿«é€Ÿå®šä½é”™è¯¯ï¼Œæ’æŸ¥æ“ä½œå¤±è´¥åŸå› ã€‚</p><p><img src=/images/docs-tutorials/log.png alt></p><h3 id=ä»»åŠ¡å¤±è´¥åé‡è¯•>ä»»åŠ¡å¤±è´¥åé‡è¯•</h3><p>å¯¹äºä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œä½†æ’æŸ¥é”™è¯¯åŸå› åä¸éœ€è¦ä¿®æ”¹ä»»åŠ¡å‚æ•°çš„æƒ…å†µï¼Œæ‚¨å¯ä»¥ç‚¹å‡»æ“ä½œæ—¥å¿—å³ä¾§çš„â€œä»æ–­ç‚¹å¤„é‡è¯•â€æŒ‰é’®ï¼Œä»æ–­ç‚¹å¤„é‡æ–°æ‰§è¡Œä»»åŠ¡ã€‚</p><p>æ³¨æ„ï¼šé‡è¯•æ“ä½œå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ‚¨éœ€è¦è‡ªè¡Œåˆ¤æ–­ä»»åŠ¡æ‰§è¡Œå¤±è´¥çš„åŸå› ï¼Œå¤„ç†åå¦‚æœä¸éœ€è¦æ›´æ”¹æ‰§è¡Œä»»åŠ¡æ—¶å¡«å†™çš„å‚æ•°ï¼Œå°±å¯ä»¥ç‚¹å‡»é‡è¯•æŒ‰é’®ï¼Œä»é”™è¯¯å¤„é‡æ–°å¼€å§‹æ‰§è¡Œã€‚</p><p>é›†ç¾¤æ“ä½œï¼ˆå¦‚åˆ›å»ºã€æ¢å¤ã€å‡çº§ç­‰ï¼‰æ‰§è¡Œå¤±è´¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´é›†ç¾¤çŠ¶æ€æ˜¾ç¤ºä¸ºâ€œxxå¤±è´¥â€å¹¶æ— æ³•æ­£å¸¸æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚æœä»æ–­ç‚¹å¤„é‡è¯•ä¹Ÿæ— æ³•æ‰§è¡ŒæˆåŠŸï¼Œæ‚¨å¯ä»¥å‚è€ƒè¿ç»´æ–‡æ¡£ï¼Œæ‰‹åŠ¨ä¿®å¤é›†ç¾¤é—®é¢˜ã€‚é—®é¢˜ä¿®å¤åï¼Œæ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤çŠ¶æ€â€>â€œé‡ç½®çŠ¶æ€â€æŒ‰é’®ï¼Œé‡ç½®é›†ç¾¤è‡³æ­£å¸¸çŠ¶æ€ã€‚</p><h2 id=è®¿é—®é›†ç¾¤-kubectl>è®¿é—®é›†ç¾¤ kubectl</h2><p>Kubectl æ˜¯ Kubernetes å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‚¨å¯ä»¥ç”¨å®ƒåœ¨ Kubernetes é›†ç¾¤ä¸Šè¿è¡Œå‘½ä»¤ã€‚Kubectl å¯ç”¨äºéƒ¨ç½²åº”ç”¨ã€æŸ¥çœ‹å’Œç®¡ç†é›†ç¾¤èµ„æºã€æŸ¥çœ‹æ—¥å¿—ç­‰ã€‚</p><p>æ‚¨å¯ä»¥è®¿é—®è¿è¡Œä¸­é›†ç¾¤çš„ kubectlï¼Œç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€œ>â€è®¿é—® kubectlâ€ï¼Œå°±å¯ä»¥åœ¨é›†ç¾¤ kuebectl å¼¹çª—ä¸­æ‰§è¡Œ kubectl å‘½ä»¤è¡Œæ“ä½œã€‚</p><p><img src=/images/docs-tutorials/kubectl.png alt></p><h2 id=é›†ç¾¤è®¾ç½®>é›†ç¾¤è®¾ç½®</h2><h3 id=ç¼–è¾‘>ç¼–è¾‘</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤åˆ—è¡¨å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤è®¾ç½®â€>â€œç¼–è¾‘â€æŒ‰é’®ï¼Œç¼–è¾‘é›†ç¾¤æè¿°ã€å¤‡ä»½ç©ºé—´ã€å¤–éƒ¨è®¿é—® IPã€é›†ç¾¤æ ‡ç­¾ä¿¡æ¯ã€‚</p><h3 id=ä¿å­˜ä¸ºæ¨¡ç‰ˆ>ä¿å­˜ä¸ºæ¨¡ç‰ˆ</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤åˆ—è¡¨å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤è®¾ç½®â€>â€œä¿å­˜ä¸ºæ¨¡ç‰ˆâ€æŒ‰é’®ï¼Œå°†é›†ç¾¤ä¿¡æ¯ä¿å­˜ä¸ºæ¨¡ç‰ˆï¼Œä»¥ä¾¿å†æ¬¡åˆ›å»ºç›¸ä¼¼é…ç½®çš„é›†ç¾¤æ—¶ä½¿ç”¨ã€‚</p><h3 id=cri-é•œåƒä»“åº“é…ç½®>CRI é•œåƒä»“åº“é…ç½®</h3><p>Docker å’Œ Containerd ä½¿ç”¨ dockerhub ä½œä¸ºé»˜è®¤é•œåƒä»“åº“ï¼Œå¦‚æœæ‚¨éœ€è¦ä½¿ç”¨å…¶ä»–é•œåƒä»“åº“ï¼ˆç‰¹åˆ«æ˜¯ä½¿ç”¨è‡ªç­¾å https ä»“åº“æˆ–è€… http ä»“åº“ï¼‰ï¼Œæ‚¨éœ€è¦é…ç½® CRI é•œåƒä»“åº“ã€‚</p><p>ç‚¹å‡»é›†ç¾¤å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤è®¾ç½®â€>â€œCRI é•œåƒä»“åº“â€æŒ‰é’®ï¼Œåœ¨ CRI é•œåƒä»“åº“å¼¹çª—ä¸­ï¼Œé…ç½®æ‚¨éœ€è¦çš„é•œåƒä»“åº“ï¼Œæ‚¨å¯ä»¥é€‰æ‹©å¹³å°ä¸­å·²å­˜åœ¨çš„é•œåƒä»“åº“ï¼Œä¹Ÿå¯ä»¥ä¸´æ—¶å¡«å†™é•œåƒä»“åº“åœ°å€ã€‚å¯¹äºè‡ªç­¾å https ä»“åº“æˆ–è€… http ä»“åº“ï¼Œå»ºè®®æ‚¨å…ˆåœ¨â€œé›†ç¾¤ç®¡ç†â€>â€œé•œåƒä»“åº“â€é¡µé¢æ·»åŠ ä»“åº“ä¿¡æ¯ï¼Œå†åœ¨æ­¤æ“ä½œä¸­é…ç½®ã€‚</p><h2 id=é›†ç¾¤èŠ‚ç‚¹ç®¡ç†>é›†ç¾¤èŠ‚ç‚¹ç®¡ç†</h2><p>åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„â€œèŠ‚ç‚¹â€åˆ—è¡¨é¡µé¢ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å½“å‰é›†ç¾¤ä¸­çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ŒèŠ‚ç‚¹çš„è§„æ ¼ã€çŠ¶æ€å’Œè§’è‰²ä¿¡æ¯ã€‚</p><p><img src=/images/docs-tutorials/cluster.png alt></p><h3 id=æ·»åŠ é›†ç¾¤èŠ‚ç‚¹>æ·»åŠ é›†ç¾¤èŠ‚ç‚¹</h3><p>å½“é›†ç¾¤è´Ÿè½½è¾ƒé«˜æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¸ºé›†ç¾¤æ·»åŠ èŠ‚ç‚¹æ¥è¾¾åˆ°ä¸»åŠ¨æ‰©å®¹çš„ç›®çš„ï¼Œæ·»åŠ æ–°çš„â€œèŠ‚ç‚¹â€ä¸ä¼šå½±å“ç°æœ‰çš„ä¸šåŠ¡çš„è¿è¡Œã€‚</p><p>åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„èŠ‚ç‚¹åˆ—è¡¨æ ‡ç­¾é¡µä¸‹ï¼Œç‚¹å‡»å·¦ä¾§çš„â€œæ·»åŠ èŠ‚ç‚¹â€æŒ‰é’®ï¼Œåœ¨å¼¹çª—ä¸­é€‰æ‹©å¯ç”¨èŠ‚ç‚¹ï¼Œè®¾ç½®èŠ‚ç‚¹æ ‡ç­¾ï¼Œç‚¹å‡»â€œç¡®è®¤â€æŒ‰é’®ã€‚å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒæ·»åŠ å·¥ä½œèŠ‚ç‚¹ã€‚</p><h3 id=ç§»é™¤é›†ç¾¤èŠ‚ç‚¹>ç§»é™¤é›†ç¾¤èŠ‚ç‚¹</h3><p>åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„èŠ‚ç‚¹åˆ—è¡¨æ ‡ç­¾é¡µä¸‹ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»èŠ‚ç‚¹å³ä¾§çš„ â€œç§»é™¤â€æŒ‰é’®ç§»é™¤èŠ‚ç‚¹ã€‚å½“å‰ç‰ˆæœ¬ä»…æ”¯æŒç§»é™¤å·¥ä½œèŠ‚ç‚¹ã€‚</p><p>æ³¨æ„ï¼šç§»é™¤é›†ç¾¤èŠ‚ç‚¹ï¼Œæ‚¨éœ€è¦æ³¨æ„ç”Ÿäº§ä¸­çš„å®‰å…¨é—®é¢˜ï¼Œé¿å…åº”ç”¨å‘ç”Ÿä¸­æ–­ã€‚</p><h2 id=é›†ç¾¤å¤‡ä»½å’Œæ¢å¤>é›†ç¾¤å¤‡ä»½å’Œæ¢å¤</h2><p>KubeClipper å¯¹ kubernetes é›†ç¾¤çš„å¤‡ä»½ä¸»è¦ä¸ºå¤‡ä»½ ETCD æ•°æ®åº“æ•°æ®ï¼Œä»¥åŠ kubernetes çš„èµ„æºå¯¹è±¡å¤‡ä»½ï¼Œå¦‚ namespaceï¼Œdeploymentã€configMapã€‚å¯¹èµ„æºè‡ªèº«äº§ç”Ÿçš„æ–‡ä»¶å’Œæ•°æ®ä¸åšå¤‡ä»½ï¼Œä¾‹å¦‚å¯¹é›†ç¾¤ä¸­è¿è¡Œçš„ mysql podï¼Œè¯¥ mysql pod äº§ç”Ÿçš„æ•°æ®å’Œæ–‡ä»¶ï¼Œä¸ä¼šä¸ºä¹‹å¤‡ä»½ï¼ŒåŒç†ï¼Œæ–‡ä»¶ç±»çš„ pv å¯¹è±¡ä¸‹çš„æ–‡ä»¶ï¼Œä¹Ÿä¸åšå¤‡ä»½ï¼Œä»…ä»…å¤‡ä»½ pv è¿™ä¸ªå¯¹è±¡ã€‚KubeClipper æä¾›çš„å¤‡ä»½åŠŸèƒ½æ˜¯çƒ­å¤‡ä»½ï¼Œå¤‡ä»½æœŸé—´ä¸å½±å“é›†ç¾¤çš„ä½¿ç”¨ã€‚KubeClipper è™½ç„¶ä¸åå¯¹åœ¨é›†ç¾¤ &ldquo;ç¹å¿™æœŸ&rdquo; å¤‡ä»½ï¼Œä½†ä¹Ÿå¼ºçƒˆä¸èµæˆåœ¨é›†ç¾¤ &ldquo;ç¹å¿™æœŸ&rdquo; å¤‡ä»½ã€‚</p><h3 id=åˆ›å»ºå¤‡ä»½ç©ºé—´>åˆ›å»ºå¤‡ä»½ç©ºé—´</h3><p>æ‰§è¡Œå¤‡ä»½ä¹‹å‰ï¼Œæ‚¨éœ€è¦å…ˆä¸ºé›†ç¾¤è®¾ç½®å¤‡ä»½ç©ºé—´ï¼Œå³è®¾ç½®å¤‡ä»½æ–‡ä»¶çš„å­˜å‚¨ä½ç½®ã€‚å¤‡ä»½ç©ºé—´çš„å­˜å‚¨ç±»å‹å¯ä»¥æ˜¯ FS å­˜å‚¨æˆ– S3 å­˜å‚¨ï¼Œä¸‹é¢ä»¥èŠ‚ç‚¹æœ¬åœ°å­˜å‚¨ã€NFS å­˜å‚¨å’Œ MINIO å­˜å‚¨ä¸ºä¾‹ï¼š</p><ul><li><strong>èŠ‚ç‚¹æœ¬åœ°å­˜å‚¨ï¼ˆä»…é€‚ç”¨å•èŠ‚ç‚¹å®éªŒé›†ç¾¤ï¼‰ï¼š</strong></li></ul><ol><li>åˆ›å»ºå­˜å‚¨ç›®å½•ã€‚è¿æ¥é›†ç¾¤ master èŠ‚ç‚¹ç»ˆç«¯ï¼ˆå¯å‚è§<a href=/docs/tutorials/node-management/#%E8%BF%9E%E6%8E%A5%E7%BB%88%E7%AB%AF>è¿æ¥èŠ‚ç‚¹ç»ˆç«¯</a>ï¼‰ï¼Œä½¿ç”¨ mkdir å‘½ä»¤ï¼Œåœ¨ master èŠ‚ç‚¹ä¸­åˆ›å»ºâ€œ/root/backupâ€ç›®å½•ã€‚</li><li>åˆ›å»ºå¤‡ä»½ç©ºé—´ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œå¤‡ä»½ç©ºé—´â€ï¼Œè¿›å…¥å¤‡ä»½ç©ºé—´åˆ—è¡¨é¡µï¼Œç‚¹å‡»å³ä¸Šè§’â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œåœ¨åˆ›å»ºå¤‡ä»½ç©ºé—´å¼¹çª—ä¸­ï¼Œè¾“å…¥â€œå¤‡ä»½ç©ºé—´åç§°â€ï¼Œå¦‚ â€œlocalâ€ï¼Œé€‰æ‹©â€œå­˜å‚¨ç±»å‹â€ä¸º â€œFSâ€ï¼Œå¡«å†™â€œå¤‡ä»½è·¯å¾„â€ï¼Œå¦‚ â€œ/root/backupâ€ã€‚</li><li>è®¾ç½®é›†ç¾¤å¤‡ä»½ç©ºé—´ã€‚åˆ›å»ºé›†ç¾¤æ—¶ï¼Œåœ¨â€œé›†ç¾¤é…ç½®â€é¡µé¢é€‰æ‹©â€œå¤‡ä»½ç©ºé—´â€ä¸º â€œlocalâ€ï¼Œæˆ–è€…ç¼–è¾‘å·²æœ‰é›†ç¾¤ï¼Œåœ¨ç¼–è¾‘é›†ç¾¤å¼¹çª—ä¸­çš„â€œå¤‡ä»½ç©ºé—´â€ä¸­é€‰æ‹© â€œlocalâ€ã€‚</li></ol><p>æ³¨æ„ï¼šä½¿ç”¨æœ¬åœ°èŠ‚ç‚¹å­˜å‚¨å¤‡ä»½æ–‡ä»¶ï¼Œä¸éœ€è¦å¼•å…¥å¤–éƒ¨å­˜å‚¨ï¼Œç¼ºç‚¹æ˜¯å¦‚æœæœ¬åœ°èŠ‚ç‚¹é­åˆ°ç ´åï¼Œå¤‡ä»½æ–‡ä»¶ä¹Ÿä¼šä¸¢å¤±ï¼Œæ‰€ä»¥å¼ºçƒˆä¸èµæˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p><ul><li><strong>NFSï¼š</strong></li></ul><ol><li><p>å‡†å¤‡ NFS å­˜å‚¨ã€‚å‡†å¤‡ä¸€å° NFS æœåŠ¡ï¼Œå¹¶åœ¨ NFS æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªç”¨äºå­˜æ”¾å¤‡ä»½æ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚ â€œ/data/kubeclipper/cluster-backupsâ€ã€‚</p></li><li><p>æŒ‚è½½å­˜å‚¨ç›®å½•ã€‚è¿æ¥é›†ç¾¤ master èŠ‚ç‚¹ç»ˆç«¯ï¼ˆå¯å‚è§<a href=/docs/tutorials/node-management/#%E8%BF%9E%E6%8E%A5%E7%BB%88%E7%AB%AF>è¿æ¥èŠ‚ç‚¹ç»ˆç«¯</a>ï¼‰ï¼Œä½¿ç”¨ mkdir å‘½ä»¤ï¼Œåœ¨æ¯ä¸ª master èŠ‚ç‚¹ä¸­åˆ›å»º â€œ/data/kubeclipper/cluster-backupsâ€ ç›®å½•ï¼Œå¹¶ mount åˆ° NFS æœåŠ¡å™¨çš„ /data/kubeclipper/cluster-backups ç›®å½•å³å¯ã€‚</p><p>å‘½ä»¤ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mount -t nfs <span style=color:#ce5c00;font-weight:700>{</span> NFS_IP <span style=color:#ce5c00;font-weight:700>}</span>:/data/kubeclipper/cluster-backups /opt/kubeclipper/cluster-backups -o <span style=color:#000>proto</span><span style=color:#ce5c00;font-weight:700>=</span>tcp -o nolock
</span></span></code></pre></div></li><li><p>åˆ›å»ºå¤‡ä»½ç©ºé—´ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œå¤‡ä»½ç©ºé—´â€ï¼Œè¿›å…¥å¤‡ä»½ç©ºé—´åˆ—è¡¨é¡µï¼Œç‚¹å‡»å³ä¸Šè§’â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œåœ¨åˆ›å»ºå¤‡ä»½ç©ºé—´å¼¹çª—ä¸­ï¼Œè¾“å…¥â€œå¤‡ä»½ç©ºé—´åç§°â€ï¼Œå¦‚ â€œnfsâ€ï¼Œé€‰æ‹©â€œå­˜å‚¨ç±»å‹â€ä¸º â€œFSâ€ï¼Œå¡«å†™â€œå¤‡ä»½è·¯å¾„â€ä¸º â€œ/opt/kubeclipper/cluster-backupsâ€ã€‚</p></li><li><p>è®¾ç½®é›†ç¾¤å¤‡ä»½ç©ºé—´ã€‚åˆ›å»ºé›†ç¾¤æ—¶ï¼Œåœ¨â€œé›†ç¾¤é…ç½®â€é¡µé¢é€‰æ‹©â€œå¤‡ä»½ç©ºé—´â€ä¸º â€œnfsâ€ï¼Œæˆ–è€…ç¼–è¾‘å·²æœ‰é›†ç¾¤ï¼Œåœ¨ç¼–è¾‘é›†ç¾¤å¼¹çª—ä¸­çš„â€œå¤‡ä»½ç©ºé—´â€ä¸­é€‰æ‹© â€œnfsâ€ã€‚</p></li></ol><ul><li><strong>MINIOï¼š</strong></li></ul><ol><li>å‡†å¤‡ MINIO å­˜å‚¨ã€‚æ­å»º MINIO æœåŠ¡ï¼Œéƒ¨ç½²è¿‡ç¨‹å‚è€ƒå®˜ç½‘ <a href=https://docs.min.io/docs/minio-quickstart-guide.html>https://docs.min.io/docs/minio-quickstart-guide.html</a>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å·²æœ‰ MINIO æœåŠ¡ã€‚</li><li>åˆ›å»ºå¤‡ä»½ç©ºé—´ã€‚ç‚¹å‡»â€œé›†ç¾¤ç®¡ç†â€>â€œå¤‡ä»½ç©ºé—´â€ï¼Œè¿›å…¥å¤‡ä»½ç©ºé—´åˆ—è¡¨é¡µï¼Œç‚¹å‡»å³ä¸Šè§’â€œåˆ›å»ºâ€æŒ‰é’®ï¼Œåœ¨åˆ›å»ºå¤‡ä»½ç©ºé—´å¼¹çª—ä¸­ï¼Œè¾“å…¥â€œå¤‡ä»½ç©ºé—´åç§°â€ï¼Œå¦‚ â€œminioâ€ï¼Œé€‰æ‹©â€œå­˜å‚¨ç±»å‹â€ä¸º â€œS3â€ï¼Œå¡«å†™ â€œbucket åç§°â€ï¼Œå¦‚ â€œkubeclipper-backupsâ€ï¼Œè¯¥ bucket å°†ç”± kubeclipper è‡ªåŠ¨åˆ›å»ºï¼Œâ€œEndpointâ€ ä¸­å¡«å†™ç¬¬ä¸€æ­¥ MINIO å­˜å‚¨æœåŠ¡çš„ ip å’Œç«¯å£å·ï¼Œå¡«å†™æœåŠ¡ç”¨æˆ·åå’Œå¯†ç ï¼Œç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ã€‚</li><li>è®¾ç½®é›†ç¾¤å¤‡ä»½ç©ºé—´ã€‚åˆ›å»ºé›†ç¾¤æ—¶ï¼Œåœ¨â€œé›†ç¾¤é…ç½®â€é¡µé¢é€‰æ‹©â€œå¤‡ä»½ç©ºé—´â€ä¸º â€œminioâ€ï¼Œæˆ–è€…ç¼–è¾‘å·²æœ‰é›†ç¾¤ï¼Œåœ¨ç¼–è¾‘é›†ç¾¤å¼¹çª—ä¸­çš„â€œå¤‡ä»½ç©ºé—´â€ä¸­é€‰æ‹©â€œminioâ€ã€‚</li></ol><p>æ‚¨å¯ä»¥åœ¨â€œé›†ç¾¤ç®¡ç†â€çš„â€œå¤‡ä»½ç©ºé—´â€é¡µé¢æŸ¥çœ‹æ‰€æœ‰å¤‡ä»½ç©ºé—´åˆ—è¡¨å’Œè¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ç¼–è¾‘ï¼šç¼–è¾‘å¤‡ä»½ç©ºé—´æè¿°ï¼Œå’Œ S3 ç±»å‹å¤‡ä»½ç©ºé—´çš„ç”¨æˆ·å/å¯†ç ã€‚</p></li><li><p>åˆ é™¤ï¼šåˆ é™¤å¤‡ä»½ç©ºé—´ï¼Œå¤‡ä»½ç©ºé—´ä¸‹å­˜åœ¨å¤‡ä»½æ–‡ä»¶çš„ï¼Œä¸å…è®¸åˆ é™¤ã€‚</p></li></ul><h3 id=é›†ç¾¤å¤‡ä»½>é›†ç¾¤å¤‡ä»½</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œå¤‡ä»½å’Œæ¢å¤â€> â€œé›†ç¾¤å¤‡ä»½â€æŒ‰é’®ï¼Œå¤‡ä»½é›†ç¾¤ ETCD æ•°æ®ã€‚</p><p>æ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µé¢çš„å¤‡ä»½æ ‡ç­¾é¡µä¸‹ï¼ŒæŸ¥çœ‹å½“å‰é›†ç¾¤çš„æ‰€æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å¯¹å¤‡ä»½æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ç¼–è¾‘ï¼šç¼–è¾‘å¤‡ä»½æè¿°ã€‚</p></li><li><p>æ¢å¤ï¼šæ‰§è¡Œé›†ç¾¤æ¢å¤æ“ä½œï¼Œå°†é›†ç¾¤æ¢å¤è‡³æŒ‡å®šå¤‡ä»½çŠ¶æ€ã€‚</p></li><li><p>åˆ é™¤ï¼šåˆ é™¤æŒ‡å®šå¤‡ä»½æ–‡ä»¶ã€‚</p></li></ul><h3 id=å®šæ—¶å¤‡ä»½>å®šæ—¶å¤‡ä»½</h3><p>æ‚¨ä¹Ÿå¯ä»¥ä¸ºé›†ç¾¤åˆ›å»ºå®šæ—¶å¤‡ä»½ï¼Œç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œå¤‡ä»½å’Œæ¢å¤â€> â€œå®šæ—¶å¤‡ä»½â€æŒ‰é’®ï¼Œåœ¨å®šæ—¶å¤‡ä»½å¼¹çª—ä¸­ï¼Œè¾“å…¥å®šæ—¶å¤‡ä»½åç§°ã€æ‰§è¡Œç±»å‹ï¼ˆé‡å¤æ‰§è¡Œ/ä»…æ‰§è¡Œä¸€æ¬¡ï¼‰å’Œæ‰§è¡Œæ—¶é—´ï¼Œå¹¶ä¸ºé‡å¤æ‰§è¡Œçš„å®šæ—¶å¤‡ä»½è®¾ç½®æœ‰æ•ˆå¤‡ä»½ä¸ªæ•°ï¼Œç‚¹å‡»â€œç¡®è®¤â€æŒ‰é’®ã€‚</p><p>kubeClipper ä¼šåœ¨æ‚¨è®¾ç½®çš„æ‰§è¡Œæ—¶é—´ä¸ºé›†ç¾¤æ‰§è¡Œå¤‡ä»½ä»»åŠ¡ï¼Œå¤‡ä»½æ–‡ä»¶ä¼šè‡ªåŠ¨å‘½åä¸ºâ€œé›†ç¾¤åç§°-å®šæ—¶å¤‡ä»½åç§°-éšæœºç â€ï¼Œå¯¹äºé‡å¤æ‰§è¡Œçš„å®šæ—¶å¤‡ä»½ï¼ŒkubeClipper ä¼šåœ¨è¯¥å®šæ—¶ä»»åŠ¡ä¸‹çš„å¤‡ä»½æ–‡ä»¶è¶…è¿‡æœ‰æ•ˆå¤‡ä»½ä¸ªæ•°æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤è¶…å‡ºä¸ªæ•°çš„è¾ƒæ—©çš„å¤‡ä»½æ–‡ä»¶ã€‚</p><p>å®šæ—¶å¤‡ä»½æ·»åŠ å®Œæˆåï¼Œå¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„â€œå®šæ—¶å¤‡ä»½â€æ ‡ç­¾é¡µæŸ¥çœ‹å®šæ—¶å¤‡ä»½ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åœ¨â€œå¤‡ä»½â€æ ‡ç­¾é¡µæŸ¥çœ‹å®šæ—¶å¤‡ä»½äº§ç”Ÿçš„å¤‡ä»½æ–‡ä»¶ã€‚</p><p>å¯¹äºå®šæ—¶å¤‡ä»½ä»»åŠ¡ï¼Œæ‚¨è¿˜å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ç¼–è¾‘ï¼šç¼–è¾‘å®šæ—¶å¤‡ä»½ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œå’Œé‡å¤æ‰§è¡Œçš„å®šæ—¶å¤‡ä»½çš„æœ‰æ•ˆå¤‡ä»½ä¸ªæ•°ã€‚</p></li><li><p>å¯ç”¨/ç¦ç”¨ï¼šç¦ç”¨çš„å®šæ—¶å¤‡ä»½ä»»åŠ¡å°†æš‚æ—¶åœæ­¢æ‰§è¡Œã€‚</p></li><li><p>åˆ é™¤ï¼šåˆ é™¤å®šæ—¶å¤‡ä»½ä»»åŠ¡ã€‚</p></li></ul><h3 id=é›†ç¾¤å¤‡ä»½æ¢å¤>é›†ç¾¤å¤‡ä»½æ¢å¤</h3><p>å¦‚æœæ‚¨åœ¨é›†ç¾¤æ­£å¸¸è¿è¡ŒæœŸé—´æ‰§è¡Œæ¢å¤æ“ä½œï¼Œåˆ™ KubeClipper å°†å¯¹è¯¥é›†ç¾¤è¿›è¡Œè¦†ç›–å¼æ¢å¤ï¼Œå°±æ˜¯å¤‡ä»½æ–‡ä»¶é‡Œé¢çš„ etcd æ•°æ®ï¼Œè¦†ç›–ç°æœ‰çš„æ•°æ®ã€‚</p><p>æ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„å¤‡ä»½æ ‡ç­¾é¡µä¸‹ï¼Œç‚¹å‡»å¤‡ä»½å³ä¾§çš„ â€œæ¢å¤â€æŒ‰é’®ï¼›æˆ–ç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œå¤‡ä»½å’Œæ¢å¤â€>â€œæ¢å¤é›†ç¾¤â€æŒ‰é’®ï¼Œåœ¨æ¢å¤é›†ç¾¤å¼¹çª—ä¸­é€‰æ‹©éœ€è¦æ¢å¤çš„å¤‡ä»½ï¼Œå¯ä»¥å°†å½“å‰é›†ç¾¤æ¢å¤è‡³æŒ‡å®šå¤‡ä»½çŠ¶æ€ã€‚</p><p>æ³¨æ„ï¼šé›†ç¾¤å‡çº§åï¼Œå°†æ— æ³•å†æ¢å¤åˆ°å‡çº§å‰ç‰ˆæœ¬çš„å¤‡ä»½ã€‚</p><h2 id=é›†ç¾¤çŠ¶æ€>é›†ç¾¤çŠ¶æ€</h2><h3 id=é›†ç¾¤ç‰ˆæœ¬å‡çº§>é›†ç¾¤ç‰ˆæœ¬å‡çº§</h3><p>å¦‚å½“é›†ç¾¤ç‰ˆæœ¬ä¸æ»¡è¶³éœ€è¦ï¼Œæ‚¨å¯ä»¥ä¸ºé›†ç¾¤å‡çº§ kubernetes ç‰ˆæœ¬ã€‚ä¸åˆ›å»ºé›†ç¾¤ä¸€æ ·ï¼Œæ‚¨éœ€è¦å‡†å¤‡å¥½é›†ç¾¤ç‰ˆæœ¬æ‰€éœ€é…ç½®åŒ…å’Œç›®æ ‡ç‰ˆæœ¬çš„ kubernetes é•œåƒå¹¶ä¸Šä¼ è‡³æŒ‡å®šä½ç½®ï¼Œè¯¦æƒ…å‚è§<a href=/docs/tutorials/create-clusters/#%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C>åˆ›å»ºé›†ç¾¤å‡†å¤‡å·¥ä½œ</a>ã€‚</p><p>ç‚¹å‡»é›†ç¾¤æ“ä½œçš„â€œæ›´å¤šâ€>â€œé›†ç¾¤çŠ¶æ€â€> â€œé›†ç¾¤å‡çº§â€æŒ‰é’®ï¼Œåœ¨é›†ç¾¤å‡çº§å¼¹çª—ä¸­é€‰æ‹©å®‰è£…æ–¹å¼å’Œé•œåƒä»“åº“ï¼Œé€‰æ‹©å‡çº§çš„ç›®æ ‡ç‰ˆæœ¬ï¼Œå‡çº§çš„å®‰è£…æ–¹å¼å’Œ kubernetes ç‰ˆæœ¬çš„é…ç½®ä¸åˆ›å»ºé›†ç¾¤ç›¸åŒï¼Œè¯¦æƒ…å‚è§<a href=/docs/tutorials/create-clusters/#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE>é›†ç¾¤é…ç½®æŒ‡å—</a>ã€‚</p><p>é›†ç¾¤å‡çº§å¯ä»¥è·¨å°ç‰ˆæœ¬ï¼Œä½†ä¸æ”¯æŒç•¥è¿‡æ¬¡ç‰ˆæœ¬çš„å‡çº§ï¼Œå¦‚æ‚¨å¯ä»¥ä» v1.20.2 å‡çº§åˆ° v1.20.13ï¼Œæˆ–ç”± v1.20.x å‡çº§åˆ° v1.21.xï¼Œä½†ä¸æ”¯æŒä» v1.20.x å‡çº§åˆ° v1.22.xã€‚å¯¹äº 1.23.x ç‰ˆæœ¬ï¼Œæš‚ä¸æ”¯æŒå‡çº§åˆ° 1.24.x ç‰ˆæœ¬ã€‚</p><p>å‡çº§é›†ç¾¤æ“ä½œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œæ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µé¢æŸ¥çœ‹æ“ä½œæ—¥å¿—ï¼Œè·Ÿè¸ªé›†ç¾¤å‡çº§çŠ¶æ€ã€‚</p><h3 id=åˆ é™¤é›†ç¾¤>åˆ é™¤é›†ç¾¤</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤åˆ—è¡¨å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤çŠ¶æ€â€> â€œåˆ é™¤â€æŒ‰é’®ï¼Œåˆ é™¤é›†ç¾¤ã€‚</p><p>æ³¨æ„åˆ é™¤åé›†ç¾¤ä¸å¯æ¢å¤ã€‚è¯·è°¨æ…æ“ä½œã€‚å¦‚æœé›†ç¾¤å¯¹æ¥äº†å¤–éƒ¨å­˜å‚¨ï¼Œå›æ”¶ç­–ç•¥ä¸ºâ€œä¿ç•™â€çš„å­˜å‚¨ç±»ä¸­çš„æ•°æ®å·ä¼šè¢«ä¿ç•™ï¼Œæ‚¨å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼è®¿é—®ï¼Œæˆ–æ‰‹åŠ¨åˆ é™¤ï¼›å›æ”¶ç­–ç•¥ä¸ºâ€œåˆ é™¤â€çš„å­˜å‚¨ç±»ä¸­çš„æ•°æ®å·ï¼Œä¼šåœ¨åˆ é™¤é›†ç¾¤æ—¶è‡ªåŠ¨åˆ é™¤ã€‚</p><h3 id=é‡ç½®çŠ¶æ€>é‡ç½®çŠ¶æ€</h3><p>é›†ç¾¤æ“ä½œï¼ˆå¦‚åˆ›å»ºã€æ¢å¤ã€å‡çº§ç­‰ï¼‰æ‰§è¡Œå¤±è´¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´é›†ç¾¤çŠ¶æ€æ˜¾ç¤ºä¸ºâ€œxxå¤±è´¥â€å¹¶æ— æ³•æ­£å¸¸æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦‚æœä»æ–­ç‚¹å¤„é‡è¯•ä¹Ÿæ— æ³•æ‰§è¡ŒæˆåŠŸï¼Œæ‚¨å¯ä»¥å‚è€ƒè¿ç»´æ–‡æ¡£ï¼Œæ‰‹åŠ¨ä¿®å¤é›†ç¾¤é—®é¢˜ã€‚é—®é¢˜ä¿®å¤åï¼Œæ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤å³ä¾§â€œæ›´å¤šâ€>â€œé›†ç¾¤çŠ¶æ€â€>â€œé‡ç½®çŠ¶æ€â€æŒ‰é’®ï¼Œé‡ç½®é›†ç¾¤è‡³æ­£å¸¸çŠ¶æ€ã€‚</p><h2 id=é›†ç¾¤æ’ä»¶ç®¡ç†>é›†ç¾¤æ’ä»¶ç®¡ç†</h2><p>é™¤äº†åœ¨åˆ›å»ºé›†ç¾¤æ—¶å®‰è£…æ’ä»¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¸ºè¿è¡Œä¸­çš„é›†ç¾¤å®‰è£…å­˜å‚¨å’Œå…¶ä»–è‡ªå®šä¹‰æ’ä»¶ã€‚ä»¥å®‰è£…å­˜å‚¨æ’ä»¶ä¸ºä¾‹ï¼Œç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œæ’ä»¶ç®¡ç†â€>â€œæ·»åŠ å­˜å‚¨é¡¹â€æŒ‰é’®ï¼Œè¿›å…¥æ·»åŠ å­˜å‚¨é¡¹é¡µé¢ï¼Œå¯ä»¥ä¸ºé›†ç¾¤å®‰è£…å­˜å‚¨æ’ä»¶ï¼Œå®‰è£…é…ç½®ä¸åˆ›å»ºé›†ç¾¤ä¸­çš„é…ç½®ç›¸åŒã€‚</p><p>å¯¹äºå·²å®‰è£…çš„æ’ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µæŸ¥çœ‹æ’ä»¶ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ä¿å­˜ä¸ºæ¨¡ç‰ˆï¼šå°†æ’ä»¶ä¿¡æ¯ä¿å­˜ä¸ºæ¨¡ç‰ˆï¼Œä»¥ä¾¿ä¸ºå…¶ä»–é›†ç¾¤ä½¿ç”¨ã€‚</p></li><li><p>ç§»é™¤æ’ä»¶ï¼šå¸è½½é›†ç¾¤æ’ä»¶ã€‚</p></li></ul><h2 id=é›†ç¾¤è¯ä¹¦ç®¡ç†>é›†ç¾¤è¯ä¹¦ç®¡ç†</h2><h3 id=æ›´æ–°é›†ç¾¤è¯ä¹¦>æ›´æ–°é›†ç¾¤è¯ä¹¦</h3><p>kubernetes é›†ç¾¤è¯ä¹¦é»˜è®¤æœ‰æ•ˆæœŸä¸ºä¸€å¹´ï¼Œæ‚¨å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µçš„åŸºæœ¬ä¿¡æ¯ä¸­æŸ¥çœ‹è¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œè¯ä¹¦è¿‡æœŸå‰ä¸€å¤©ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨é›†ç¾¤åˆ—è¡¨çœ‹åˆ°è¯ä¹¦è¿‡æœŸçš„æé†’ã€‚æ›´æ–°é›†ç¾¤è¯ä¹¦ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œé›†ç¾¤è¯ä¹¦â€>â€œæ›´æ–°é›†ç¾¤è¯ä¹¦â€æŒ‰é’®ï¼Œæ›´æ–°é›†ç¾¤å…¨éƒ¨è¯ä¹¦ã€‚</p><h3 id=è·å–-kubeconfig-æ–‡ä»¶>è·å– kubeconfig æ–‡ä»¶</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»é›†ç¾¤æ“ä½œä¸­çš„â€œæ›´å¤šâ€>â€œé›†ç¾¤è¯ä¹¦â€>â€œæŸ¥çœ‹ kubeconfig æ–‡ä»¶â€æŒ‰é’®ï¼ŒæŸ¥çœ‹é›†ç¾¤ kubeconfig æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»å¼¹çª—ä¸­çš„â€œä¸‹è½½â€æŒ‰é’®ï¼Œä¸‹è½½ kubeconfig æ–‡ä»¶ã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-14a1d24a0e318e4086c90931bd9e8c35>4.4 - èŠ‚ç‚¹ç®¡ç†</h1><div class=lead>KubeClipper æ”¯æŒè·¨åŒºåŸŸçš„èŠ‚ç‚¹å’Œé›†ç¾¤ç®¡ç†ã€‚</div><h2 id=åŒºåŸŸç®¡ç†>åŒºåŸŸç®¡ç†</h2><p>å¹³å°æ”¯æŒå¤šåŒºåŸŸç®¡ç†ï¼Œå³ä¸ºå¹³å°ç®¡ç†çš„æ‰€æœ‰èŠ‚ç‚¹å’Œé›†ç¾¤è¿›è¡Œç‰©ç†æˆ–é€»è¾‘çš„åŒºåŸŸåˆ’åˆ†ã€‚æ‚¨å¯ä»¥åœ¨â€œåŒºåŸŸç®¡ç†â€é¡µé¢æŸ¥çœ‹å¹³å°å†…ç®¡ç†çš„æ‰€æœ‰åŒºåŸŸï¼Œç‚¹å‡»åŒºåŸŸåç§°ï¼Œè¿›å…¥åŒºåŸŸè¯¦æƒ…é¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹åŒºåŸŸä¸‹çš„æ‰€æœ‰é›†ç¾¤åˆ—è¡¨å’ŒèŠ‚ç‚¹åˆ—è¡¨ã€‚</p><p><img src=/images/docs-tutorials/region.png alt></p><h2 id=èŠ‚ç‚¹ç®¡ç†>èŠ‚ç‚¹ç®¡ç†</h2><p>æ‚¨å¯ä»¥åœ¨â€œèŠ‚ç‚¹ä¿¡æ¯â€é¡µé¢æŸ¥çœ‹å¹³å°ä¸­ç®¡ç†çš„å…¨éƒ¨èŠ‚ç‚¹åˆ—è¡¨ï¼Œå’ŒèŠ‚ç‚¹è§„æ ¼ã€çŠ¶æ€ç­‰ä¿¡æ¯ã€‚ç‚¹å‡»èŠ‚ç‚¹åç§°è¿›å…¥èŠ‚ç‚¹è¯¦æƒ…é¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹è¯¦ç»†çš„èŠ‚ç‚¹åŸºæœ¬ä¿¡æ¯å’Œç³»ç»Ÿä¿¡æ¯ã€‚</p><p>KubeClipper ä¸­çš„èŠ‚ç‚¹çŠ¶æ€è¡¨ç¤º kc-agent å¯¹èŠ‚ç‚¹çš„ç®¡ç†çŠ¶æ€ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒèŠ‚ç‚¹çŠ¶æ€æ˜¾ç¤ºä¸ºâ€œå°±ç»ªâ€ï¼Œå½“èŠ‚ç‚¹å¤±è”4åˆ†é’Ÿï¼ˆè¯¯å·®æ—¶é—´ 10s å†…ï¼‰åï¼ŒçŠ¶æ€ä¼šæ›´æ–°ä¸ºâ€œæœªçŸ¥â€ï¼ŒæœªçŸ¥çŠ¶æ€çš„èŠ‚ç‚¹æ— æ³•è¿›è¡Œä»»ä½•æ“ä½œï¼Œä¹Ÿæ— æ³•åˆ›å»ºé›†ç¾¤æˆ–ä¸ºé›†ç¾¤æ·»åŠ /ç§»é™¤èŠ‚ç‚¹ã€‚</p><h3 id=æ·»åŠ èŠ‚ç‚¹>æ·»åŠ èŠ‚ç‚¹</h3><p>åœ¨éƒ¨ç½² KubeClipper æ—¶ï¼Œæ‚¨å°±å¯ä»¥æ·»åŠ åˆå§‹çš„ server èŠ‚ç‚¹å’Œ agent èŠ‚ç‚¹ï¼Œå…¶ä¸­ï¼Œserver èŠ‚ç‚¹ç”¨äºéƒ¨ç½² KubeClipper è‡ªèº«æœåŠ¡ï¼Œagent èŠ‚ç‚¹å¯ç”¨äºéƒ¨ç½² kubernetes é›†ç¾¤ã€‚åœ¨ç”¨äºå®éªŒæˆ–å¼€å‘çš„ KubeClipper ç¯å¢ƒï¼Œæ‚¨å¯ä»¥å°† server èŠ‚ç‚¹åŒæ—¶æ·»åŠ ä¸º agent èŠ‚ç‚¹ã€‚ä½†å¦‚æœç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®ä¸è¦å°† server èŠ‚ç‚¹å¤ç”¨ä¸º agent èŠ‚ç‚¹ã€‚</p><p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ kcctl join å‘½ä»¤ä¸º KubeClipper æ·»åŠ  agent èŠ‚ç‚¹ã€‚åŒæ—¶ï¼Œæ‚¨å¯ä»¥ä¸ºæ¯ä¸ª agent èŠ‚ç‚¹æ ‡è®°ä¸€ä¸ªåŒºåŸŸï¼ŒåŒºåŸŸå¯ä»¥æ˜¯ç‰©ç†çš„æˆ–é€»è¾‘çš„ä½ç½®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åŒä¸€åŒºåŸŸçš„èŠ‚ç‚¹åˆ›å»º kubernetes é›†ç¾¤ï¼Œä½†ä¸å¯ä»¥ä½¿ç”¨è·¨åŒºåŸŸçš„èŠ‚ç‚¹åˆ›å»ºé›†ç¾¤ã€‚æœªæ ‡è®°åŒºåŸŸçš„èŠ‚ç‚¹é»˜è®¤å±äº default åŒºåŸŸã€‚</p><p>å‘½ä»¤è¡Œç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kcctl join --agent beijing:1.2.3.4 --agent shanghai:2.3.4.5
</span></span></code></pre></div><h3 id=ç§»é™¤èŠ‚ç‚¹>ç§»é™¤èŠ‚ç‚¹</h3><p>å½“æ‚¨ä¸å†éœ€è¦æŸäº›èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ kcctl drain å‘½ä»¤å°†èŠ‚ç‚¹ä»å¹³å°ä¸­ç§»é™¤ã€‚</p><p>å‘½ä»¤è¡Œç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kcctl drain --agent 192.168.10.19
</span></span></code></pre></div><h3 id=è¿æ¥ç»ˆç«¯>è¿æ¥ç»ˆç«¯</h3><p>åœ¨èŠ‚ç‚¹åˆ—è¡¨é¡µé¢ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»ç›®æ ‡èŠ‚ç‚¹å³ä¾§çš„â€œè¿æ¥ç»ˆç«¯â€æŒ‰é’®ï¼Œåœ¨è¿æ¥ç»ˆç«¯çš„å¼¹çª—ä¸­è¾“å…¥èŠ‚ç‚¹ç«¯å£å’Œç”¨æˆ·åå¯†ç ä¿¡æ¯åï¼Œè®¿é—®èŠ‚ç‚¹ SSH æ§åˆ¶å°å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</p><h3 id=å¯ç”¨ç¦ç”¨èŠ‚ç‚¹>å¯ç”¨/ç¦ç”¨èŠ‚ç‚¹</h3><p>æ‚¨å¯ä»¥ç‚¹å‡»èŠ‚ç‚¹å³ä¾§â€œç¦ç”¨â€æŒ‰é’®æš‚æ—¶ç¦ç”¨èŠ‚ç‚¹ï¼Œç¦ç”¨çŠ¶æ€ä¸‹çš„èŠ‚ç‚¹ä¸å…è®¸åˆ›å»ºæˆ–æ·»åŠ åˆ°é›†ç¾¤ã€‚</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9db4787abe05db7c233072bf3fa9f94e>4.5 - è®¿é—®æ§åˆ¶</h1><div class=lead>KubeClipper è®¿é—®æ§åˆ¶åŠŸèƒ½ä½¿ç”¨æŒ‡å—ã€‚</div><h2 id=ç”¨æˆ·ç®¡ç†>ç”¨æˆ·ç®¡ç†</h2><p>å®‰è£… KubeClipper ä¹‹åï¼Œæ‚¨éœ€è¦åˆ›å»ºæ‰€éœ€è§’è‰²çš„ç”¨æˆ·ã€‚ä¸€å¼€å§‹ï¼Œç³»ç»Ÿé»˜è®¤åªæœ‰ä¸€ä¸ªç”¨æˆ· adminï¼Œå…·æœ‰å¹³å°ç®¡ç†å‘˜è§’è‰²ã€‚</p><p>ç‚¹å‡»â€œè®¿é—®æ§åˆ¶â€>â€œç”¨æˆ·â€ï¼Œè¿›å…¥ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»å·¦ä¸Šè§’â€œåˆ›å»ºç”¨æˆ·â€æŒ‰é’®ï¼Œåœ¨å¼¹çª—ä¸­å¡«å†™ç”¨æˆ·åã€å¯†ç ã€æ‰‹æœºå·ç ã€é‚®ç®±ç­‰ä¿¡æ¯ï¼Œå¹¶æŒ‡å®šç”¨æˆ·è§’è‰²ï¼Œç‚¹å‡»â€œç¡®è®¤â€æŒ‰é’®ã€‚ç³»ç»Ÿå†…ç½®å››ä¸ªè§’è‰²å¦‚ä¸‹ï¼š</p><ul><li><p>å¹³å°ç®¡ç†å‘˜ï¼šæ‹¥æœ‰é›†ç¾¤ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€å®¡è®¡ç®¡ç†ç­‰å…¨éƒ¨å¹³å°æŸ¥çœ‹å’Œæ“ä½œæƒé™ã€‚</p></li><li><p>é›†ç¾¤ç®¡ç†å‘˜ï¼šæ‹¥æœ‰æ‰€æœ‰é›†ç¾¤ç®¡ç†æƒé™ã€‚</p></li><li><p>ç”¨æˆ·ç®¡ç†å‘˜ï¼šæ‹¥æœ‰æ‰€æœ‰ç”¨æˆ·ç®¡ç†æƒé™ã€‚</p></li><li><p>å¹³å°åªè¯»ç”¨æˆ·ï¼šæ‹¥æœ‰å…¨éƒ¨å¹³å°æŸ¥çœ‹æƒé™ã€‚</p></li></ul><p>ç”¨æˆ·åˆ›å»ºå®Œæˆåï¼Œæ‚¨å¯ä»¥åœ¨ç”¨æˆ·è¯¦æƒ…é¡µé¢æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ç¼–è¾‘ï¼šç¼–è¾‘ç”¨æˆ·åˆ«åã€è§’è‰²ã€æ‰‹æœºå·ã€é‚®ç®±ä¿¡æ¯ã€‚</p></li><li><p>ç¼–è¾‘å¯†ç ï¼šç¼–è¾‘ç”¨æˆ·ç™»å½•å¯†ç ã€‚</p></li><li><p>åˆ é™¤ï¼šåˆ é™¤ç”¨æˆ·ã€‚</p></li></ul><p>åœ¨ç”¨æˆ·è¯¦æƒ…é¡µé¢ï¼Œæ‚¨è¿˜å¯ä»¥æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„ç™»å½•æ—¥å¿—åˆ—è¡¨ã€‚</p><p>æ‚¨å¯ä»¥ç¼–è¾‘å¹³å° /etc/kubeclipper-server/kubeclipper-server.yaml æ–‡ä»¶ï¼Œæ ¹æ®éœ€è¦è®¾ç½®ç”¨æˆ·ç™»å½•æ—¥å¿—çš„æœ€å¤§ä¿ç•™æ¡æ•°å’Œä¿ç•™æœŸé™ï¼Œæ¯ä¸ªç”¨æˆ·çš„ç™»å½•æ—¥å¿—è¶…è¿‡æœ€å¤§æ¡æ•°åï¼Œè¶…è¿‡æœ€å¤§æ¡æ•°å’ŒæœŸé™çš„æ—¥å¿—ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œä»…è¶…è¿‡ä¿ç•™æœŸé™ä½†æœªè¶…è¿‡æœ€å¤§æ¡æ•°çš„æ—¥å¿—æ•°æ®å°†ä¸ä¼šè¢«åˆ é™¤ã€‚</p><h2 id=è‡ªå®šä¹‰è§’è‰²>è‡ªå®šä¹‰è§’è‰²</h2><p>é™¤äº†ç³»ç»Ÿå†…ç½®è§’è‰²ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰è§’è‰²ï¼Œä»¥æ»¡è¶³ä¸šåŠ¡éœ€è¦ã€‚</p><p>ç‚¹å‡»â€œè®¿é—®æ§åˆ¶â€>â€œè§’è‰²â€ï¼Œè¿›å…¥è§’è‰²ç®¡ç†é¡µé¢ï¼Œæ‚¨å¯ä»¥ç‚¹å‡»å·¦ä¸Šè§’â€œåˆ›å»ºè§’è‰²â€æŒ‰é’®ï¼Œåˆ›å»ºè‡ªå®šä¹‰è§’è‰²ã€‚</p><p>åœ¨åˆ›å»ºè§’è‰²é¡µé¢ï¼Œæ‚¨éœ€è¦å¡«å†™è§’è‰²åç§°å’Œæè¿°ï¼Œå¹¶å‹¾é€‰è‡ªå®šä¹‰è§’è‰²æ‰€éœ€æƒé™ï¼Œä¸€äº›æƒé™ä¾èµ–äºå…¶ä»–æƒé™ï¼Œåœ¨é€‰æ‹©è¿™äº›æƒé™æ—¶ï¼Œå°†è‡ªåŠ¨é€‰ä¸­ä¾èµ–çš„æƒé™ã€‚</p><p>åˆ›å»ºè‡ªå®šä¹‰è§’è‰²å®Œæˆåï¼Œæ‚¨å¯ä»¥åœ¨è§’è‰²è¯¦æƒ…é¡µé¢æŸ¥çœ‹è§’è‰²åŸºæœ¬ä¿¡æ¯ã€è§’è‰²æƒé™åˆ—è¡¨ã€æˆæƒç”¨æˆ·åˆ—è¡¨ï¼Œå¹¶å¯¹è‡ªå®šä¹‰è§’è‰²æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li><p>ç¼–è¾‘ï¼šç¼–è¾‘è‡ªå®šä¹‰è§’è‰²åˆ«åã€‚</p></li><li><p>ç¼–è¾‘æƒé™ï¼šç¼–è¾‘è‡ªå®šä¹‰è§’è‰²ä¸‹çš„æƒé™ã€‚</p></li><li><p>åˆ é™¤ï¼šåˆ é™¤è‡ªå®šä¹‰è§’è‰²ï¼Œéœ€ç¡®ä¿æ²¡æœ‰ç”¨æˆ·ä½¿ç”¨å¾…åˆ é™¤è§’è‰²ã€‚</p></li></ul><h2 id=æ¥å…¥å¤–éƒ¨ç”¨æˆ·>æ¥å…¥å¤–éƒ¨ç”¨æˆ·</h2><p>KubeClipper å¯ä»¥é€šè¿‡ OIDC åè®®ä½¿ç”¨å¤–éƒ¨ç”¨æˆ·ç™»å½•ã€‚</p><p>é¦–å…ˆï¼Œå¹³å°ç®¡ç†å‘˜éœ€è¦ç™»å½•å¹³å° server èŠ‚ç‚¹ï¼Œåœ¨ kubeclipepr-server.yaml æ–‡ä»¶ä¸­çš„ authentication ä¸‹æ’å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š</p><pre tabindex=0><code class=language-undefined data-lang=undefined>oauthOptions:
    identityProviders:
    - name: keycloak
      type: OIDC
      mappingMethod: auto
      provider:
        clientID: kc
        clientSecret: EErn729BB1bKawdRtnZgrqj9Bx0]mzUs
        issuer: http://172.20.163.233:7777/auth/realms/kubeclipper
        scopes:
        - openid
        - email
        redirectURL: http://{kc-console-address}/oatuh2/redirect/{IDP-Name}
</code></pre><p>å…¶ä¸­ï¼Œâ€œproviderâ€ ä¸‹éœ€è¦æ‚¨å¡«å†™è‡ªå·±çš„ OAuth2 æœåŠ¡çš„<code>clientID</code>ã€<code>clientSecret</code>ã€<code>issuer</code>ä¿¡æ¯ï¼Œä»¥ keycloack ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=/images/docs-tutorials/keycloak-clients.png alt></p><p><img src=/images/docs-tutorials/keycloak-secret.png alt></p><p><code>redirectURL</code>ç¤ºä¾‹ï¼šhttp://172.0.0.90/oauth2/redirect/keycloack</p><p>OAuth2 ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤è®¿é—®å’Œä½¿ç”¨ KubeClipper å¹³å°ï¼š</p><ol><li>ç‚¹å‡»ç™»å½•é¡µçš„ â€œOAuth2 ç™»å½•â€æŒ‰é’®ï¼Œè¿›å…¥ OAuth2 ç™»å½•é¡µé¢ï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œè¿›å…¥ KubeClipper å¹³å°ï¼Œé¦–æ¬¡ç™»å½•ï¼Œæ‚¨ä¼šå› æœªè¢«æˆäºˆæƒé™è€Œæ— æ³•è®¿é—®å¹³å°ã€‚</li><li>å¹³å°ç®¡ç†å‘˜æˆ–å…¶ä»–æ‹¥æœ‰ç”¨æˆ·ç®¡ç†æƒé™çš„ç”¨æˆ·ç™»å½• KubeClipperï¼Œåœ¨ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œæ‰¾åˆ°ç›®æ ‡ OAuth2 ç”¨æˆ·ï¼Œé€šè¿‡ç¼–è¾‘ç”¨æˆ·æŒ‡å®šç”¨æˆ·è§’è‰²ã€‚</li><li>OAuth2 ç”¨æˆ·é‡å¤ç¬¬ä¸€æ­¥ï¼Œç™»å½• KubeClipperï¼Œå°±å¯ä»¥æ­£å¸¸è®¿é—®å¹³å°å¹¶æ‰§è¡Œè§’è‰²æƒé™å†…æ“ä½œã€‚</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-2a24abb89b7115d59d639d3389ce3c9b>5 - å¸¸è§é—®é¢˜</h1><div class=lead>å¸¸è§é—®é¢˜è®°å½•</div></div><div class=td-content><h1 id=pg-54fa90c08fd01c12b3bbec84936325aa>5.1 - é€šè¿‡ kcctl å‘½ä»¤åˆ›å»ºé›†ç¾¤é”™è¯¯</h1><div class=lead>åœ¨ v1.2.1 ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬ v1.2.1ï¼‰ä¹‹å‰ï¼Œä½¿ç”¨ <code>kcctl create cluster</code> å‘½ä»¤åˆ›å»ºé›†ç¾¤åŠŸèƒ½ï¼Œä¼šå‘ç”Ÿåˆ›å»ºå¤±è´¥é”™è¯¯ï¼Œä»¥ä¸‹æä¾›ä¸€ç§ä¸´æ—¶çš„è§£å†³æ–¹æ³•ã€‚ åœ¨ v1.2.1 ç‰ˆæœ¬ä¹‹åï¼Œæˆ‘ä»¬ä¿®å¤äº†è¯¥é—®é¢˜ã€‚</div><h2 id=é—®é¢˜å¤ç°>é—®é¢˜å¤ç°</h2><p>å®‰è£… v1.2.1 ç‰ˆæœ¬çš„ kcctl</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -sfL https://oss.kubeclipper.io/get-kubeclipper.sh <span style=color:#000;font-weight:700>|</span> <span style=color:#000>KC_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span>v1.2.1 bash -
</span></span></code></pre></div><p>é€šè¿‡ kcctl deploy å‘½ä»¤éƒ¨ç½² KubeClipper é›†ç¾¤</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å®‰è£… AIO ç¯å¢ƒ</span>
</span></span><span style=display:flex><span>kcctl deploy
</span></span></code></pre></div><p>é€šè¿‡ kcctl create cluster å‘½ä»¤åˆ›å»º kubernetes é›†ç¾¤</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># éœ€è¦å…ˆç™»å½•</span>
</span></span><span style=display:flex><span>kcctl login --host http://127.0.0.1 --username admin --password Thinkbig1
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># åˆ›å»ºé›†ç¾¤</span>
</span></span><span style=display:flex><span>kcctl create cluster --name <span style=color:#204a87>test</span> --master 192.168.10.98 --untaint-master
</span></span></code></pre></div><p>ç™»å½• KubeClipper ç®¡ç†ç•Œé¢ï¼ŒæŸ¥çœ‹åˆ›å»ºé›†ç¾¤æ“ä½œæ—¥å¿—ï¼Œæ—¥å¿—æ˜¾ç¤ºåœ¨å®‰è£… cni è¿‡ç¨‹ä¸­å‘ç°ä¸‹è½½ calico v3.21.2 404 æ— æ³•æ‰¾åˆ°</p><p><img src=/images/docs-faq/create-cluster-error.png alt></p><h2 id=é—®é¢˜ä¿®å¤-pr>é—®é¢˜ä¿®å¤ PR</h2><p>æäº¤å·²ç»åˆå¹¶åˆ°äº† masterï¼ŒPRï¼šhttps://github.com/kubeclipper/kubeclipper/commit/7e6eb0ed199ff1cb00fde0c2624c62cdc5ca0b9c</p><p>ä½† v1.2.1 å·²ç»å‘å¸ƒäº†ï¼ŒæŒ‰ç…§å‘ç‰ˆè§„èŒƒæ— æ³•åœ¨è¯¥ç‰ˆæœ¬æ‰“è¡¥ä¸ï¼Œéœ€è¦ç­‰åˆ°åç»­ v1.2.2 å‘å¸ƒè§£å†³ï¼Œå› æ­¤æˆ‘ä»¬æä¾›ä¸€ç§ä¸´æ—¶æ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id=è§£å†³æ–¹æ³•>è§£å†³æ–¹æ³•</h2><p>åˆ¶ä½œç¦»çº¿èµ„æºåŒ…
ä¸‹è½½ calico v3.21.2 çš„å®‰è£…åŒ…ï¼Œæ‰“åŒ…ä¸ºæŒ‡å®šæ ¼å¼çš„ç¦»çº¿èµ„æºåŒ…</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># åˆ›å»ºèµ„æºç›®å½•</span>
</span></span><span style=display:flex><span>mkdir -pv calico/v3.21.2/amd64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># ä¸‹è½½ v3.21.2 ç‰ˆæœ¬çš„ calico</span>
</span></span><span style=display:flex><span>wget -P calico/v3.21.2/amd64 https://oss.kubeclipper.io/packages/calico/v3.21.2/amd64/images.tar.gz
</span></span><span style=display:flex><span>wget -P calico/v3.21.2/amd64 https://oss.kubeclipper.io/packages/calico/v3.21.2/amd64/manifest.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># å‹ç¼©æ–‡ä»¶ä¸ºæŒ‡å®šå‘½ä»¤</span>
</span></span><span style=display:flex><span>tar -zcvf calico-v3.21.2-amd64.tar.gz calico
</span></span></code></pre></div><p>æ¨é€ç¦»çº¿èµ„æºåŒ…</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># æ¨é€</span>
</span></span><span style=display:flex><span>kcctl resource push --pkg calico-v3.21.2-amd64.tar.gz --type cni
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># éªŒè¯</span>
</span></span><span style=display:flex><span>kcctl resource list<span style=color:#000;font-weight:700>|</span>grep v3.21.2
</span></span></code></pre></div><blockquote><p>å¦‚æœåœ¨æ‰§è¡Œ <code>kcctl resource push</code> æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š
<img src=/images/docs-faq/need-login.png alt>
è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>ç¼–è¾‘ /root/.kc/deploy-config.yaml æ–‡ä»¶ã€‚</li><li>æ‰¾åˆ° ssh é…ç½®é¡¹ï¼Œæ·»åŠ  pkFile å­—æ®µé…ç½®ï¼Œå€¼ä¸ºå½“å‰æœåŠ¡å™¨çš„ ssh å…¬é’¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚<br><img src=/images/docs-faq/add-key.png alt></li></ol></blockquote><p>é€šè¿‡å‘½ä»¤è¡Œå®‰è£… kubernetes é›†ç¾¤ï¼Œåœ¨ KubeClipper ç®¡ç†åå°æŸ¥çœ‹æ“ä½œæ—¥å¿—</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kcctl create cluster --name <span style=color:#204a87>test</span> --master 192.168.10.98 --untaint-master
</span></span></code></pre></div><p>æŸ¥çœ‹ kubernetes é›†ç¾¤ pods è¿è¡ŒçŠ¶æ€</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl get pods -A
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8efbf7499fe9c7bde8d2c1bb7ff6ee3c>6 - è´¡çŒ®æŒ‡å—</h1><div class=lead>å¦‚ä½•ä¸º kubeclipper åšè´¡çŒ®</div><p>è¯·æŸ¥çœ‹ <a href=https://github.com/kubeclipper/community>KubeClipper Community</a></p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/kubeclipper/kubeclipper aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 KubeClipper ä¿ç•™æ‰€æœ‰æƒåˆ©</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>éšç§æ”¿ç­–</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.91798a335c881f1b6b805085ba4aa22d1dbd2b0b18d105d05189fa104ddae350.js integrity="sha256-kXmKM1yIHxtrgFCFukqiLR29KwsY0QXQUYn6EE3a41A=" crossorigin=anonymous></script></body></html>